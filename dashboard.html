<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RQR9BDLJ26"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-RQR9BDLJ26');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Taskflows Dashboard</title>
  <link rel="icon" type="image/x-icon" href="
Untitled-removebg-preview.png">

  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" />

  <style>
    :root {
      /* Theme Variables */
      --bg-body: #050507;
      --bg-sidebar: #0a0a0c;
      --bg-card: #121216;
      --bg-card-hover: #18181e;
      --bg-input: #1c1c22;
      --bg-modal: #18181b;

      --border: rgba(255, 255, 255, 0.08);
      --border-hover: rgba(255, 255, 255, 0.2);

      --primary: #6366f1;
      --primary-hover: #4f46e5;
      --primary-glow: rgba(99, 102, 241, 0.4);
      --accent: #8b5cf6;

      --text-main: #ffffff;
      --text-muted: #94a3b8;

      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;

      /* Animation Curves */
      --ease-elastic: cubic-bezier(0.175, 0.885, 0.32, 1.275);
      --ease-smooth: cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    [data-theme="blue"] {
      --bg-body: #0f172a;
      --bg-sidebar: #1e293b;
      --bg-card: #1e293b;
      --bg-card-hover: #334155;
      --bg-input: #334155;
      --bg-modal: #1e293b;
    }

    * {
      box-sizing: border-box;
      outline: none;
      user-select: none;
    }

    body {
      margin: 0;
      background-color: var(--bg-body);
      color: var(--text-main);
      font-family: 'Inter', sans-serif;
      height: 100vh;
      display: flex;
      overflow: hidden;
      transition: background-color 0.5s ease;
    }

    h1,
    h2,
    h3,
    h4 {
      font-family: 'Plus Jakarta Sans', sans-serif;
      margin: 0;
    }

    /* SCROLLBAR */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    /* ================= SIDEBAR ================= */
    aside {
      width: 260px;
      background: var(--bg-sidebar);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      padding: 24px;
      z-index: 10;
      transition: background 0.3s;
      /* Changed to auto to allow scrolling if menu is long */
      overflow-y: auto;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: 'Plus Jakarta Sans', sans-serif;
      font-weight: 800;
      font-size: 1.2rem;
      color: white;
      margin-bottom: 40px;
      letter-spacing: -0.02em;
      flex-shrink: 0;
    }

    /* Sidebar Section Headers */
    .nav-header {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--text-muted);
      margin: 20px 0 10px 10px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      margin-bottom: 6px;
      border-radius: 12px;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.3s var(--ease-smooth);
      font-weight: 500;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
      text-decoration: none;
      /* Added for link support */
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.05);
      color: white;
      transform: translateX(5px);
    }

    .nav-item.active {
      background: var(--primary);
      color: white;
      box-shadow: 0 4px 20px var(--primary-glow);
    }

    .nav-item:active {
      transform: scale(0.95);
    }

    /* ================= MAIN CONTENT ================= */
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      background: radial-gradient(circle at top right, rgba(99, 102, 241, 0.05) 0%, transparent 40%);
    }

    /* HEADER */
    header {
      height: 80px;
      padding: 0 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid transparent;
      transition: 0.3s;
    }

    header:hover {
      border-bottom-color: var(--border);
    }

    .greeting h2 {
      font-size: 1.5rem;
    }

    .greeting p {
      color: var(--text-muted);
      margin-top: 4px;
      font-size: 0.9rem;
    }

    .header-actions {
      display: flex;
      gap: 16px;
      align-items: center;
    }

    .btn-icon {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s var(--ease-elastic);
      position: relative;
    }

    .btn-icon:hover {
      background: var(--bg-input);
      color: white;
      border-color: var(--border-hover);
      transform: translateY(-2px);
    }

    .btn-icon:active {
      transform: scale(0.9);
    }

    .notif-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 10px;
      height: 10px;
      background: var(--danger);
      border-radius: 50%;
      border: 2px solid var(--bg-body);
      display: none;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
      }

      70% {
        box-shadow: 0 0 0 6px rgba(239, 68, 68, 0);
      }

      100% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
      }
    }

    /* VIEWS SYSTEM */
    .view-section {
      display: none;
      height: 100%;
      flex-direction: column;
      animation: fadeIn 0.4s var(--ease-smooth);
    }

    .view-section.active-view {
      display: flex;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .content-scroll {
      flex: 1;
      overflow-y: auto;
      padding: 20px 40px 40px 40px;
    }

    .grid-container {
      display: grid;
      grid-template-columns: 2.5fr 1fr;
      gap: 30px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      border: none;
      padding: 10px 24px;
      border-radius: 100px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s var(--ease-smooth);
      box-shadow: 0 4px 15px var(--primary-glow);
    }

    .btn-primary:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 8px 25px var(--primary-glow);
    }

    .btn-primary:active {
      transform: scale(0.95);
    }

    /* STATS BAR */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 40px;
    }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      padding: 24px;
      border-radius: 20px;
      transition: 0.3s;
      position: relative;
      overflow: hidden;
    }

    .stat-card:hover {
      border-color: var(--primary);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transform: translateY(-3px);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 800;
      margin: 10px 0;
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 0.9rem;
      font-weight: 500;
    }

    /* PROJECTS GRID */
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    .project-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 24px;
      cursor: pointer;
      transition: all 0.3s var(--ease-smooth);
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 15px;
      animation: slideUp 0.4s var(--ease-smooth) backwards;
    }

    /* Staggered Animation for list items */
    .project-card:nth-child(1) {
      animation-delay: 0.05s;
    }

    .project-card:nth-child(2) {
      animation-delay: 0.1s;
    }

    .project-card:nth-child(3) {
      animation-delay: 0.15s;
    }

    .project-card:nth-child(4) {
      animation-delay: 0.2s;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .project-card:hover {
      background: var(--bg-card-hover);
      transform: translateY(-5px) scale(1.02);
      border-color: var(--border-hover);
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5);
    }

    .p-badge {
      align-self: flex-start;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .p-high {
      background: rgba(239, 68, 68, 0.15);
      color: var(--danger);
    }

    .p-med {
      background: rgba(245, 158, 11, 0.15);
      color: var(--warning);
    }

    .p-low {
      background: rgba(16, 185, 129, 0.15);
      color: var(--success);
    }

    .p-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: white;
    }

    .p-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .progress-track {
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      overflow: hidden;
      margin-top: auto;
    }

    .progress-fill {
      height: 100%;
      background: var(--primary);
      width: 0%;
      transition: width 1s ease;
    }

    .p-meta {
      padding-top: 15px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* TASKS & TIMER SIDE */
    .side-panel {
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    .widget-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 24px;
    }

    .timer-display {
      font-size: 3rem;
      font-weight: 800;
      font-variant-numeric: tabular-nums;
      text-align: center;
      margin: 20px 0;
      color: white;
      text-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
    }

    .timer-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    .task-input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .glass-input {
      flex: 1;
      background: var(--bg-input);
      border: 1px solid var(--border);
      color: white;
      padding: 10px 15px;
      border-radius: 10px;
      transition: 0.3s;
    }

    .glass-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 15px var(--primary-glow);
    }

    .task-list {
      max-height: 300px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .task-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      transition: 0.2s;
      cursor: pointer;
    }

    .task-item:hover {
      background: rgba(255, 255, 255, 0.06);
    }

    .check-circle {
      width: 20px;
      height: 20px;
      border: 2px solid var(--text-muted);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: 0.2s;
    }

    .task-item.done .check-circle {
      background: var(--success);
      border-color: var(--success);
    }

    .task-item.done span {
      text-decoration: line-through;
      color: var(--text-muted);
    }

    /* MODAL SYSTEM */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: 0.3s;
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: all;
    }

    .modal-box {
      background: var(--bg-modal);
      width: 500px;
      border-radius: 24px;
      padding: 30px;
      border: 1px solid var(--border);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      transform: scale(0.9) translateY(20px);
      transition: 0.3s var(--ease-elastic);
    }

    .modal-overlay.open .modal-box {
      transform: scale(1) translateY(0);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .form-select {
      width: 100%;
      background: var(--bg-input);
      border: 1px solid var(--border);
      color: white;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
    }

    /* COMMAND PALETTE (SEARCH) */
    .cmd-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 200;
      display: flex;
      justify-content: center;
      padding-top: 100px;
      opacity: 0;
      pointer-events: none;
      transition: 0.2s;
    }

    .cmd-overlay.open {
      opacity: 1;
      pointer-events: all;
    }

    .cmd-box {
      width: 600px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      transform: scale(0.95);
      transition: 0.2s;
      max-height: 500px;
      display: flex;
      flex-direction: column;
    }

    .cmd-overlay.open .cmd-box {
      transform: scale(1);
    }

    .cmd-input {
      width: 100%;
      padding: 20px;
      background: transparent;
      border: none;
      border-bottom: 1px solid var(--border);
      color: white;
      font-size: 1.1rem;
    }

    .cmd-results {
      overflow-y: auto;
      padding: 10px;
    }

    .cmd-item {
      padding: 12px;
      border-radius: 8px;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .cmd-item:hover {
      background: var(--primary);
      color: white;
    }

    /* TOAST NOTIFICATION */
    .toast-container {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 300;
    }

    .toast {
      background: var(--bg-card);
      border: 1px solid var(--border);
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      gap: 10px;
      animation: toastIn 0.3s var(--ease-elastic);
      min-width: 300px;
    }

    @keyframes toastIn {
      from {
        opacity: 0;
        transform: translateX(50px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .toast-success {
      border-left: 4px solid var(--success);
    }

    .toast-danger {
      border-left: 4px solid var(--danger);
    }

    .toast-info {
      border-left: 4px solid var(--primary);
    }

    /* ANALYTICS CHART BAR (Simple CSS) */
    .chart-bar-container {
      display: flex;
      height: 30px;
      border-radius: 8px;
      overflow: hidden;
      margin-top: 10px;
      width: 100%;
    }

    .chart-seg {
      height: 100%;
      transition: width 0.5s;
      position: relative;
    }

    .chart-seg:hover {
      filter: brightness(1.2);
    }

    .seg-tooltip {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: black;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.7rem;
      display: none;
      white-space: nowrap;
    }

    .chart-seg:hover .seg-tooltip {
      display: block;
    }
  </style>
</head>

<body>

  <div class="toast-container" id="toast-container"></div>

  <div class="modal-overlay" id="name-modal">
    <div class="modal-box" style="text-align: center; width: 400px;">
      <span class="material-symbols-rounded"
        style="font-size: 48px; color: var(--primary); margin-bottom: 20px;">waving_hand</span>
      <h2 style="margin-bottom: 10px;">Welcome to Taskflows</h2>
      <p style="color: var(--text-muted); margin-bottom: 30px;">Let's get to know you. What should we call you?</p>
      <input type="text" id="user-name-input" class="glass-input" placeholder="Enter your name..."
        style="text-align: center; font-size: 1.1rem; margin-bottom: 20px;">
      <button class="btn-primary" style="width: 100%; justify-content: center;" onclick="saveName()">Get
        Started</button>
    </div>
  </div>

  <div class="cmd-overlay" id="search-modal" onclick="if(event.target === this) toggleSearch()">
    <div class="cmd-box">
      <input type="text" class="cmd-input" id="cmd-input" placeholder="Search projects or tasks..."
        oninput="handleSearch(this.value)" autofocus>
      <div class="cmd-results" id="cmd-results">
        <div style="padding: 20px; text-align: center; color: var(--text-muted);">Start typing to search...</div>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="settings-modal" onclick="if(event.target === this) toggleSettings()">
    <div class="modal-box">
      <h2 style="margin-bottom: 24px;">Settings</h2>

      <div class="form-group">
        <label class="form-label">Theme</label>
        <div style="display: flex; gap: 10px;">
          <button class="btn-icon" style="flex: 1; border-radius: 8px;" onclick="setTheme('default')">Midnight</button>
          <button class="btn-icon" style="flex: 1; border-radius: 8px;" onclick="setTheme('blue')">Deep Blue</button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Data Management</label>
        <button class="btn-icon"
          style="width: 100%; justify-content: flex-start; padding: 0 15px; border-color: rgba(239,68,68,0.3); color: var(--danger);"
          onclick="resetData()">
          <span class="material-symbols-rounded" style="margin-right: 10px;">delete_forever</span> Clear All Data
        </button>
      </div>

      <button class="btn-primary" style="width: 100%; justify-content: center; margin-top: 20px;"
        onclick="toggleSettings()">Close</button>
    </div>
  </div>

  <div class="modal-overlay" id="project-modal" onclick="if(event.target === this) closeModal()">
    <div class="modal-box">
      <h2 id="modal-title" style="margin-bottom: 24px;">Create New Project</h2>
      <input type="hidden" id="edit-project-id">

      <div class="form-group">
        <label class="form-label">Project Name</label>
        <input type="text" id="p-name" class="glass-input" placeholder="e.g. Q4 Website Redesign">
      </div>

      <div class="form-group">
        <label class="form-label">Description</label>
        <textarea id="p-desc" class="glass-input" rows="3" placeholder="Brief details..."></textarea>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <div class="form-group">
          <label class="form-label">Priority</label>
          <select id="p-priority" class="form-select">
            <option value="High">High</option>
            <option value="Medium" selected>Medium</option>
            <option value="Low">Low</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Due Date</label>
          <input type="date" id="p-date" class="form-select" style="color-scheme: dark;">
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Status</label>
        <select id="p-status" class="form-select">
          <option value="Active">In Progress</option>
          <option value="Planning">Planning</option>
          <option value="Review">In Review</option>
          <option value="Done">Completed</option>
        </select>
      </div>

      <div style="display: flex; gap: 10px; margin-top: 30px;">
        <button class="btn-primary" style="flex: 1; justify-content: center;" onclick="saveProject()">Save
          Project</button>
        <div id="edit-actions" style="display: contents;">
          <button class="btn-icon" onclick="duplicateProject()" title="Duplicate"><span
              class="material-symbols-rounded">content_copy</span></button>
          <button class="btn-icon" style="color: var(--danger); border-color: rgba(239,68,68,0.3);"
            onclick="deleteProject()" title="Delete"><span class="material-symbols-rounded">delete</span></button>
        </div>
      </div>
    </div>
  </div>

  <aside>
    <div class="brand">
      <span class="material-symbols-rounded" style="color: var(--primary);">layers</span>
      Taskflows Ultra
    </div>

    <div class="nav-item active" onclick="switchView('dashboard', this)">
      <span class="material-symbols-rounded">dashboard</span> Dashboard
    </div>
    <div class="nav-item" onclick="switchView('projects', this)">
      <span class="material-symbols-rounded">folder_open</span> Projects
    </div>
    <div class="nav-item" onclick="switchView('tasks', this)">
      <span class="material-symbols-rounded">check_circle</span> My Tasks
    </div>
    <div class="nav-item" onclick="switchView('analytics', this)">
      <span class="material-symbols-rounded">bar_chart</span> Analytics
    </div>

    <div class="nav-header">Workspace</div>
    <a href="text-editor.html" class="nav-item">
      <span class="material-symbols-rounded">article</span> Text Editor
    </a>
    <a href="to-do-list.html" class="nav-item">
      <span class="material-symbols-rounded">checklist</span> To-Do Lists
    </a>
    <a href="dashboard.html" class="nav-item">
      <span class="material-symbols-rounded">grid_view</span> Dashboard
    </a>
    <a href="notes.html" class="nav-item">
      <span class="material-symbols-rounded">note</span> Notes
    </a>
    <a href="whiteboard.html" class="nav-item">
      <span class="material-symbols-rounded">draw</span> Whiteboard
    </a>

    <div class="nav-header">Personal</div>
    <a href="lists.html" class="nav-item">
      <span class="material-symbols-rounded">list</span> Lists
    </a>
    <a href="journal.html" class="nav-item">
      <span class="material-symbols-rounded">book</span> Journal
    </a>
    <a href="quicknotes.html" class="nav-item">
      <span class="material-symbols-rounded">edit_note</span> Quick Notes
    </a>

    <div style="margin-top: auto; padding-top: 20px;">
      <a href="profile.html" class="nav-item">
        <span class="material-symbols-rounded">account_circle</span> Edit Profile
      </a>
    </div>

  </aside>

  <main>
    <header>
      <div class="greeting">
        <h2 id="greeting-text">Hello, User</h2>
        <p id="date-display">Fetching date...</p>
      </div>
      <div class="header-actions">
        <div class="btn-icon" onclick="toggleSearch()" title="Search (Ctrl+K)">
          <span class="material-symbols-rounded">search</span>
        </div>
        <div class="btn-icon" onclick="toggleSettings()" title="Settings">
          <span class="material-symbols-rounded">settings</span>
        </div>
        <div
          style="width: 40px; height: 40px; background: linear-gradient(135deg, #6366f1, #8b5cf6); border-radius: 50%; display: grid; place-items: center; font-weight: 700; cursor: pointer; border: 2px solid var(--bg-card);">
          ME
        </div>
      </div>
    </header>

    <div class="content-scroll">

      <div id="view-dashboard" class="view-section active-view">
        <div class="stats-bar">
          <div class="stat-card">
            <span class="material-symbols-rounded" style="color: var(--primary); font-size: 28px;">folder</span>
            <div class="stat-value" id="stat-active">0</div>
            <div class="stat-label">Active Projects</div>
          </div>
          <div class="stat-card">
            <span class="material-symbols-rounded" style="color: var(--success); font-size: 28px;">check_circle</span>
            <div class="stat-value" id="stat-tasks">0</div>
            <div class="stat-label">Tasks Completed</div>
          </div>
          <div class="stat-card">
            <span class="material-symbols-rounded" style="color: var(--warning); font-size: 28px;">bolt</span>
            <div class="stat-value" id="stat-focus">0h</div>
            <div class="stat-label">Focus Time Today</div>
          </div>
        </div>

        <div class="grid-container">
          <div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3>Recent Projects</h3>
              <button class="btn-primary" onclick="openCreateModal()">
                <span class="material-symbols-rounded">add</span> New Project
              </button>
            </div>

            <div id="projects-container" class="projects-grid"></div>
            <div id="projects-empty"
              style="text-align: center; padding: 40px; color: var(--text-muted); border: 2px dashed var(--border); border-radius: 20px; display: none;">
              No projects yet. Click "New Project" to start building.
            </div>
          </div>

          <div class="side-panel">
            <div class="widget-card">
              <div
                style="display: flex; justify-content: space-between; align-items: center; color: var(--text-muted);">
                <span style="font-size: 0.9rem; font-weight: 600; text-transform: uppercase;">Focus Timer</span>
                <span class="material-symbols-rounded">timer</span>
              </div>
              <div class="timer-display" id="timer">25:00</div>
              <div class="timer-controls">
                <button class="btn-icon" onclick="toggleTimer()" id="timer-btn">
                  <span class="material-symbols-rounded">play_arrow</span>
                </button>
                <button class="btn-icon" onclick="resetTimer()">
                  <span class="material-symbols-rounded">refresh</span>
                </button>
              </div>
            </div>

            <div class="widget-card">
              <h4 style="margin-bottom: 15px;">Quick Tasks</h4>
              <div class="task-input-group">
                <input type="text" id="quick-task" class="glass-input" placeholder="Add task..."
                  onkeypress="handleTaskKey(event)">
                <button class="btn-icon" onclick="addTask()">
                  <span class="material-symbols-rounded">add</span>
                </button>
              </div>
              <div id="task-list" class="task-list"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="view-projects" class="view-section">
        <h2 style="margin-bottom: 20px;">All Projects</h2>
        <div id="all-projects-container" class="projects-grid"></div>
      </div>

      <div id="view-tasks" class="view-section">
        <h2 style="margin-bottom: 20px;">My Tasks</h2>
        <div class="widget-card" style="min-height: 400px;">
          <div class="task-input-group">
            <input type="text" id="main-task-input" class="glass-input" placeholder="What needs to be done?"
              onkeypress="if(event.key==='Enter') addMainTask()">
            <button class="btn-primary" onclick="addMainTask()">Add Task</button>
          </div>
          <div id="main-task-list" class="task-list" style="max-height: none;"></div>
        </div>
      </div>

      <div id="view-analytics" class="view-section">
        <h2 style="margin-bottom: 20px;">Analytics Dashboard</h2>
        <div class="grid-container">
          <div class="widget-card">
            <h3 style="margin-bottom: 15px;">Project Status Distribution</h3>
            <div id="chart-status" class="chart-bar-container"></div>
            <div style="margin-top: 15px; display: flex; gap: 15px; font-size: 0.85rem; color: var(--text-muted);"
              id="legend-status"></div>
          </div>
          <div class="widget-card">
            <h3 style="margin-bottom: 15px;">Priority Breakdown</h3>
            <div id="chart-priority" class="chart-bar-container"></div>
            <div style="margin-top: 15px; display: flex; gap: 15px; font-size: 0.85rem; color: var(--text-muted);"
              id="legend-priority"></div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <script>
    // ================= STATE MANAGEMENT =================
    const state = {
      name: localStorage.getItem('tf_name') || null,
      theme: localStorage.getItem('tf_theme') || 'default',
      projects: JSON.parse(localStorage.getItem('tf_projects')) || [],
      tasks: JSON.parse(localStorage.getItem('tf_tasks')) || [],
      timerRunning: false,
      timeLeft: 25 * 60,
      timerId: null
    };

    // ================= INITIALIZATION =================
    window.onload = () => {
      initDate();
      setTheme(state.theme);

      if (!state.name) {
        document.getElementById('name-modal').classList.add('open');
      } else {
        updateGreeting();
      }

      refreshAllViews();

      // Keyboard Shortcuts
      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
          e.preventDefault();
          toggleSearch();
        }
        if (e.key === 'Escape') {
          document.getElementById('search-modal').classList.remove('open');
          document.getElementById('settings-modal').classList.remove('open');
          closeModal();
        }
      });
    };

    function saveData() {
      localStorage.setItem('tf_projects', JSON.stringify(state.projects));
      localStorage.setItem('tf_tasks', JSON.stringify(state.tasks));
      refreshAllViews();
    }

    function refreshAllViews() {
      renderProjects('projects-container'); // Dashboard view
      renderProjects('all-projects-container'); // Projects view
      renderTasks('task-list'); // Dashboard widget
      renderTasks('main-task-list'); // Tasks view
      renderAnalytics();
      updateStats();
    }

    function initDate() {
      const options = { weekday: 'long', month: 'long', day: 'numeric' };
      document.getElementById('date-display').textContent = new Date().toLocaleDateString('en-US', options);
    }

    function showToast(msg, type = 'info') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast toast-${type}`;

      let icon = 'info';
      if (type === 'success') icon = 'check_circle';
      if (type === 'danger') icon = 'error';

      toast.innerHTML = `<span class="material-symbols-rounded" style="color:var(--${type})">${icon}</span> ${msg}`;

      container.appendChild(toast);

      // Remove after 3 seconds
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(10px)';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    // ================= NAVIGATION =================
    function switchView(viewName, el) {
      // Nav styles
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      if (el) el.classList.add('active');

      // View visibility
      document.querySelectorAll('.view-section').forEach(section => {
        section.classList.remove('active-view');
      });
      document.getElementById(`view-${viewName}`).classList.add('active-view');
    }

    // ================= SETTINGS & SEARCH =================
    function toggleSettings() {
      document.getElementById('settings-modal').classList.toggle('open');
    }

    function toggleSearch() {
      const modal = document.getElementById('search-modal');
      const input = document.getElementById('cmd-input');
      modal.classList.toggle('open');
      if (modal.classList.contains('open')) {
        setTimeout(() => input.focus(), 100);
        input.value = '';
        handleSearch('');
      }
    }

    function setTheme(themeName) {
      document.body.setAttribute('data-theme', themeName);
      state.theme = themeName;
      localStorage.setItem('tf_theme', themeName);
    }

    function handleSearch(query) {
      const resultsDiv = document.getElementById('cmd-results');
      resultsDiv.innerHTML = '';
      const q = query.toLowerCase();

      if (!q) {
        resultsDiv.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-muted);">Type to search...</div>';
        return;
      }

      // Search Projects
      const matchedProjects = state.projects.filter(p => p.name.toLowerCase().includes(q));
      // Search Tasks
      const matchedTasks = state.tasks.filter(t => t.text.toLowerCase().includes(q));

      if (matchedProjects.length === 0 && matchedTasks.length === 0) {
        resultsDiv.innerHTML = '<div style="padding: 10px; color: var(--text-muted);">No results found.</div>';
        return;
      }

      if (matchedProjects.length > 0) {
        const header = document.createElement('div');
        header.innerText = "PROJECTS";
        header.style.cssText = "font-size: 0.75rem; font-weight:700; color:var(--text-muted); margin: 10px 0 5px 10px;";
        resultsDiv.appendChild(header);

        matchedProjects.forEach(p => {
          const el = document.createElement('div');
          el.className = 'cmd-item';
          el.innerHTML = `<span class="material-symbols-rounded">folder</span> ${p.name}`;
          el.onclick = () => {
            openEditModal(p.id);
            toggleSearch();
          };
          resultsDiv.appendChild(el);
        });
      }

      if (matchedTasks.length > 0) {
        const header = document.createElement('div');
        header.innerText = "TASKS";
        header.style.cssText = "font-size: 0.75rem; font-weight:700; color:var(--text-muted); margin: 15px 0 5px 10px;";
        resultsDiv.appendChild(header);

        matchedTasks.forEach(t => {
          const el = document.createElement('div');
          el.className = 'cmd-item';
          el.innerHTML = `<span class="material-symbols-rounded">check_circle</span> ${t.text}`;
          el.onclick = () => {
            toggleSearch();
            switchView('tasks', document.querySelectorAll('.nav-item')[2]);
          };
          resultsDiv.appendChild(el);
        });
      }
    }

    // ================= ONBOARDING =================
    function saveName() {
      const input = document.getElementById('user-name-input');
      if (input.value.trim()) {
        state.name = input.value.trim();
        localStorage.setItem('tf_name', state.name);
        document.getElementById('name-modal').classList.remove('open');
        updateGreeting();
        showToast(`Welcome aboard, ${state.name}!`, 'success');
      }
    }

    function updateGreeting() {
      const hour = new Date().getHours();
      let greeting = "Good Morning";
      if (hour >= 12) greeting = "Good Afternoon";
      if (hour >= 18) greeting = "Good Evening";
      document.getElementById('greeting-text').textContent = `${greeting}, ${state.name}`;
    }

    // ================= PROJECTS LOGIC =================
    function openCreateModal() {
      document.getElementById('modal-title').textContent = "Create New Project";
      document.getElementById('edit-project-id').value = "";
      document.getElementById('p-name').value = "";
      document.getElementById('p-desc').value = "";
      document.getElementById('p-priority').value = "Medium";
      document.getElementById('p-date').value = "";
      document.getElementById('p-status').value = "Active";
      document.getElementById('edit-actions').style.display = "none"; // Hide delete/duplicate on create
      document.getElementById('project-modal').classList.add('open');
    }

    function openEditModal(id) {
      const p = state.projects.find(x => x.id === id);
      if (!p) return;

      document.getElementById('modal-title').textContent = "Edit Project";
      document.getElementById('edit-project-id').value = p.id;
      document.getElementById('p-name').value = p.name;
      document.getElementById('p-desc').value = p.desc;
      document.getElementById('p-priority').value = p.priority;
      document.getElementById('p-date').value = p.date;
      document.getElementById('p-status').value = p.status;
      document.getElementById('edit-actions').style.display = "contents"; // Show actions
      document.getElementById('project-modal').classList.add('open');
    }

    function closeModal() {
      document.getElementById('project-modal').classList.remove('open');
    }

    function saveProject() {
      const id = document.getElementById('edit-project-id').value;
      const name = document.getElementById('p-name').value;
      if (!name) return showToast('Project name required', 'danger');

      const projectData = {
        id: id ? parseInt(id) : Date.now(),
        name: name,
        desc: document.getElementById('p-desc').value,
        priority: document.getElementById('p-priority').value,
        date: document.getElementById('p-date').value || "No Date",
        status: document.getElementById('p-status').value
      };

      if (id) {
        const index = state.projects.findIndex(x => x.id == id);
        state.projects[index] = projectData;
        showToast('Project updated successfully', 'success');
      } else {
        state.projects.unshift(projectData);
        showToast('New project created', 'success');
      }

      saveData();
      closeModal();
    }

    function duplicateProject() {
      const id = document.getElementById('edit-project-id').value;
      const p = state.projects.find(x => x.id == id);
      if (p) {
        const newP = { ...p, id: Date.now(), name: p.name + " (Copy)" };
        state.projects.unshift(newP);
        saveData();
        closeModal();
        showToast('Project duplicated', 'info');
      }
    }

    function deleteProject() {
      const id = document.getElementById('edit-project-id').value;
      if (id && confirm("Delete this project permanently?")) {
        state.projects = state.projects.filter(x => x.id != id);
        saveData();
        closeModal();
        showToast('Project deleted', 'danger');
      }
    }

    function renderProjects(containerId) {
      const container = document.getElementById(containerId);
      const empty = document.getElementById('projects-empty');

      container.innerHTML = '';

      if (state.projects.length === 0 && containerId === 'projects-container') {
        if (empty) empty.style.display = 'block';
        return;
      }
      if (empty) empty.style.display = 'none';

      state.projects.forEach(p => {
        let prioClass = 'p-med';
        if (p.priority === 'High') prioClass = 'p-high';
        if (p.priority === 'Low') prioClass = 'p-low';

        // Calculate fake progress based on status
        let progress = 10;
        if (p.status === 'Active') progress = 45;
        if (p.status === 'Review') progress = 80;
        if (p.status === 'Done') progress = 100;
        if (p.status === 'Planning') progress = 10;

        const card = document.createElement('div');
        card.className = 'project-card';
        card.onclick = () => openEditModal(p.id);
        card.innerHTML = `
            <div style="display:flex; justify-content:space-between;">
                <span class="p-badge ${prioClass}">${p.priority}</span>
                <span style="font-size:0.8rem; color:var(--text-muted);">${p.status}</span>
            </div>
            <div>
                <div class="p-title">${p.name}</div>
                <div class="p-desc">${p.desc || 'No description provided.'}</div>
            </div>
            
            <div class="progress-track">
                <div class="progress-fill" style="width: ${progress}%"></div>
            </div>

            <div class="p-meta">
                <span><span class="material-symbols-rounded" style="font-size:16px; vertical-align:middle;">calendar_today</span> ${p.date}</span>
            </div>
        `;
        container.appendChild(card);
      });
    }

    // ================= TASK LOGIC =================
    function handleTaskKey(e) {
      if (e.key === 'Enter') addTask();
    }

    function addTask() {
      const input = document.getElementById('quick-task');
      if (input.value.trim()) {
        state.tasks.unshift({
          id: Date.now(),
          text: input.value.trim(),
          done: false
        });
        input.value = '';
        saveData();
        showToast('Task added', 'success');
      }
    }

    function addMainTask() {
      const input = document.getElementById('main-task-input');
      if (input.value.trim()) {
        state.tasks.unshift({
          id: Date.now(),
          text: input.value.trim(),
          done: false
        });
        input.value = '';
        saveData();
        showToast('Task added', 'success');
      }
    }

    function toggleTask(id) {
      const task = state.tasks.find(x => x.id === id);
      if (task) {
        task.done = !task.done;
        saveData();
      }
    }

    function deleteTask(id, e) {
      e.stopPropagation();
      state.tasks = state.tasks.filter(x => x.id !== id);
      saveData();
      showToast('Task removed', 'info');
    }

    function renderTasks(containerId) {
      const list = document.getElementById(containerId);
      list.innerHTML = '';

      if (state.tasks.length === 0) {
        list.innerHTML = `<div style="text-align:center; padding:20px; color:var(--text-muted); font-size:0.9rem;">No tasks yet.</div>`;
        return;
      }

      state.tasks.forEach(t => {
        const item = document.createElement('div');
        item.className = `task-item ${t.done ? 'done' : ''}`;
        item.onclick = () => toggleTask(t.id);
        item.innerHTML = `
            <div class="check-circle">
                ${t.done ? '<span class="material-symbols-rounded" style="font-size:14px; color:white;">check</span>' : ''}
            </div>
            <span style="flex:1; font-size:0.9rem;">${t.text}</span>
            <span class="material-symbols-rounded" style="color:var(--text-muted); font-size:18px;" onclick="deleteTask(${t.id}, event)">close</span>
        `;
        list.appendChild(item);
      });
    }

    // ================= TIMER LOGIC =================
    function toggleTimer() {
      const btn = document.querySelector('#timer-btn span');
      if (state.timerRunning) {
        clearInterval(state.timerId);
        state.timerRunning = false;
        btn.textContent = 'play_arrow';
      } else {
        state.timerId = setInterval(() => {
          state.timeLeft--;
          updateTimerDisplay();
          if (state.timeLeft <= 0) {
            clearInterval(state.timerId);
            state.timerRunning = false;
            btn.textContent = 'play_arrow';
            showToast("Focus Session Complete!", "success");
          }
        }, 1000);
        state.timerRunning = true;
        btn.textContent = 'pause';
      }
    }

    function resetTimer() {
      if (state.timerRunning) toggleTimer();
      state.timeLeft = 25 * 60;
      updateTimerDisplay();
    }

    function updateTimerDisplay() {
      const m = Math.floor(state.timeLeft / 60).toString().padStart(2, '0');
      const s = (state.timeLeft % 60).toString().padStart(2, '0');
      document.getElementById('timer').textContent = `${m}:${s}`;
    }

    // ================= ANALYTICS & UTILS =================
    function updateStats() {
      document.getElementById('stat-active').textContent = state.projects.filter(p => p.status !== 'Done').length;
      document.getElementById('stat-tasks').textContent = state.tasks.filter(t => t.done).length;
      const focusHours = Math.round(state.tasks.filter(t => t.done).length * 0.5);
      document.getElementById('stat-focus').textContent = `${focusHours}h`;
    }

    function renderAnalytics() {
      // Simple stacked bar chart logic using CSS
      renderChart('chart-status', 'legend-status', state.projects, 'status',
        { 'Active': '#6366f1', 'Planning': '#f59e0b', 'Review': '#8b5cf6', 'Done': '#10b981' });

      renderChart('chart-priority', 'legend-priority', state.projects, 'priority',
        { 'High': '#ef4444', 'Medium': '#f59e0b', 'Low': '#10b981' });
    }

    function renderChart(chartId, legendId, data, key, colors) {
      const chart = document.getElementById(chartId);
      const legend = document.getElementById(legendId);
      chart.innerHTML = ''; legend.innerHTML = '';

      if (data.length === 0) {
        chart.style.background = '#333';
        chart.innerHTML = '<div style="width:100%; text-align:center; color:#999; line-height:30px; font-size:0.8rem;">No Data</div>';
        return;
      }

      const counts = {};
      data.forEach(item => { counts[item[key]] = (counts[item[key]] || 0) + 1; });

      for (const [label, color] of Object.entries(colors)) {
        const count = counts[label] || 0;
        if (count > 0) {
          const width = (count / data.length) * 100;
          const seg = document.createElement('div');
          seg.className = 'chart-seg';
          seg.style.width = `${width}%`;
          seg.style.background = color;
          seg.innerHTML = `<div class="seg-tooltip">${label}: ${count}</div>`;
          chart.appendChild(seg);

          legend.innerHTML += `<div style="display:flex; align-items:center; gap:5px;"><div style="width:8px; height:8px; border-radius:50%; background:${color}"></div>${label}</div>`;
        }
      }
    }

    function resetData() {
      if (confirm("This will erase all your dashboard data. Are you sure?")) {
        localStorage.clear();
        location.reload();
      }
    }
  </script>
</body>

</html>
