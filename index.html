<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RQR9BDLJ26"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RQR9BDLJ26');
  </script>
  <meta charset="UTF-8">
  <title>TaskFlows</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="icon" type="image/x-icon" href="faviconfortaskflows.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #885af8;
      --primary2: #ff6ccc;
      --primary-light: #f5f2fe;
      --sidebar-bg: #fafbfc;
      --selected-bg: #f3f0fa;
      --card-bg: #fff;
      --glass: rgba(255,255,255,0.65);
      --glass2: rgba(255,255,255,0.53);
      --border: #ececec;
      --gray: #9ba3af;
      --gray-dark: #4a5568;
      --danger: #ff5449;
      --success: #3fb950;
      --warning: #e32a16;
      --info: #2b7cff;
      --shadow: 0 8px 48px 0 #885af811, 0 2px 10px 0 #885af822;
      --radius: 1.2rem;
      --transition: 0.2s;
      --fab-size: 64px;
    }
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      min-height: 100vh;
      font-family: 'Inter', Arial, sans-serif;
      background: linear-gradient(-45deg, #f7b267, #70a1d7, #b5faff, #eeecfc, #fff8e1, #f5f2fe);
      background-size: 400% 400%;
      animation: animatedGradient 14s ease-in-out infinite;
      color: #222;
      overflow-x: hidden;
      font-size: 16px;
    }
    @keyframes animatedGradient {
      0% {background-position: 0% 50%;}
      25% {background-position: 100% 60%;}
      50% {background-position: 100% 100%;}
      75% {background-position: 50% 0%;}
      100% {background-position: 0% 50%;}
    }
    .container {
      display: flex;
      min-height: 100vh;
      width: 100vw;
      max-width: 1300px;
      margin: 0 auto;
      position: relative;
      backdrop-filter: none;
    }
    .sidebar {
      background: var(--glass2);
      width: 260px;
      padding: 28px 20px 20px 20px;
      border-right: 1.5px solid var(--border);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      position: fixed;
      height: 100vh;
      z-index: 12;
      left: 0;
      top: 0;
      box-shadow: 4px 0 24px #885af829;
      backdrop-filter: blur(13px) saturate(1.2);
      transition: left 0.3s;
    }
    .sidebar.hide {
      left: -290px;
    }
    .sidebar.open {
      left: 0;
    }
    .hamburger {
      display: none;
      position: fixed;
      z-index: 10001;
      left: 18px;
      top: 20px;
      width: 46px;
      height: 46px;
      background: var(--primary-light);
      border: 2px solid var(--primary2);
      border-radius: 12px;
      box-shadow: 0 4px 18px #885af822;
      cursor: pointer;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, border 0.2s;
    }
    .hamburger:focus { outline: 2px solid var(--primary2);}
    .hamburger-icon {
      width: 28px;
      height: 24px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .hamburger-bar {
      width: 100%;
      height: 4px;
      background: var(--primary);
      border-radius: 2px;
      transition: all 0.3s;
    }
    .logo {
      display: flex;
      align-items: center;
      margin-bottom: 44px;
    }
    .logo-icon {
      background: linear-gradient(135deg, var(--primary2) 0%, var(--primary) 100%);
      color: #fff;
      border-radius: 10px;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.5rem;
      margin-right: 15px;
      box-shadow: 0 2px 10px #885af822;
    }
    .logo-text {
      font-weight: 700;
      font-size: 1.28rem;
      letter-spacing: -1px;
      color: #2d1f46;
      background: linear-gradient(90deg, var(--primary), var(--primary2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .nav-section {
      margin-bottom: 36px;
    }
    .nav-title {
      color: var(--gray);
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 13px;
      margin-top: 26px;
    }
    .nav {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .nav-item {
      display: flex;
      align-items: center;
      padding: 13px 16px;
      margin-bottom: 7px;
      border-radius: 9px;
      color: var(--gray-dark);
      font-weight: 500;
      cursor: pointer;
      transition: background var(--transition), color 0.12s;
      font-size: 1.09rem;
      gap: 14px;
      background: none;
      border: none;
      outline: none;
    }
    .nav-item.selected, .nav-item:hover {
      background: linear-gradient(90deg, var(--primary-light) 60%, #fff 100%);
      color: var(--primary);
      box-shadow: 0 1px 8px #885af822;
    }
    .nav-icon {
      width: 22px;
      text-align: center;
      font-size: 1.22rem;
    }
    .settings-link {
      display: flex;
      align-items: center;
      padding: 12px 10px;
      border-radius: 10px;
      color: var(--gray);
      font-size: 1.08rem;
      margin-top: 14px;
      cursor: pointer;
      transition: background var(--transition), color 0.14s;
      gap: 13px;
      background: none;
      border: none;
      outline: none;
    }
    .settings-link:hover {
      background: #f4f2f8;
      color: var(--primary2);
    }
    .main {
      flex: 1;
      margin-left: 260px;
      min-width: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      width: auto;
      background: none;
      transition: margin-left 0.3s;
    }
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 28px 38px 0 38px;
      min-height: 80px;
      background: transparent;
    }
    .topbar-left {
      display: flex;
      align-items: center;
      gap: 20px;
      flex: 1;
    }
    .search-bar {
      flex: 1;
      position: relative;
      max-width: 500px;
    }
    .search-bar input {
      width: 100%;
      padding: 13px 44px 13px 18px;
      border: 1.6px solid var(--primary-light);
      border-radius: 1.1rem;
      background: var(--glass2);
      font-size: 1.11rem;
      outline: none;
      transition: border 0.13s, background 0.13s;
      font-weight: 500;
      color: #2b2b4b;
      box-shadow: 0 1px 8px #d8cfff33;
      backdrop-filter: blur(2px);
    }
    .search-bar input:focus {
      border: 1.6px solid var(--primary2);
      background: #fff;
    }
    .search-icon {
      position: absolute;
      right: 14px;
      top: 12px;
      color: var(--primary2);
      font-size: 1.19rem;
      pointer-events: none;
    }
    .topbar-right {
      display: flex;
      align-items: center;
      gap: 24px;
    }
    .main-content {
      flex: 1;
      padding: 22px 38px 44px 38px;
      background: transparent;
    }
    .projects-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      gap: 20px;
      flex-wrap: wrap;
    }
    .projects-title {
      display: flex;
      align-items: center;
      font-size: 2.1rem;
      font-weight: 700;
      gap: 18px;
      background: linear-gradient(90deg, var(--primary), var(--primary2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .projects-title-icon {
      background: var(--primary-light);
      color: var(--primary2);
      border-radius: 11px;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      box-shadow: 0 1px 10px #885af822;
    }
    .projects-desc {
      color: var(--gray-dark);
      font-size: 1.18rem;
      margin-left: 4px;
      font-weight: 500;
      margin-top: 2px;
      text-shadow: 0 2px 12px #fff7;
    }
    .new-project-btn {
      background: linear-gradient(90deg, var(--primary2), var(--primary));
      color: #fff;
      border: none;
      border-radius: 1em;
      padding: 13px 34px;
      font-size: 1.13rem;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.14s, box-shadow 0.13s, color 0.11s;
      box-shadow: 0 2px 14px #885af830;
      display: flex;
      align-items: center;
      gap: 12px;
      outline: none;
      margin-left: 10px;
    }
    .new-project-btn:hover {
      background: linear-gradient(90deg,var(--primary),var(--primary2));
      color: #fff;
      box-shadow: 0 4px 24px #ff6ccc33;
    }
    .stats-row {
      display: flex;
      gap: 25px;
      margin-bottom: 32px;
      flex-wrap: wrap;
    }
    .stat-card {
      flex: 1 1 170px;
      background: var(--glass);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 22px 18px 18px 22px;
      display: flex;
      align-items: center;
      gap: 20px;
      border: 1.4px solid var(--primary-light);
      min-width: 150px;
      backdrop-filter: blur(10px) saturate(1.2);
    }
    .stat-icon {
      font-size: 1.5rem;
      color: var(--primary);
      background: var(--primary-light);
      padding: 12px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 1px 6px #885af811;
    }
    .stat-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }
    .stat-label {
      font-size: 1.07rem;
      color: var(--gray-dark);
      font-weight: 500;
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #222;
    }
    .stat-value.orange {
      color: #f97316;
    }
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 28px;
      margin-top: 13px;
    }
    .project-card {
      background: var(--glass);
      border-radius: 1.2em;
      box-shadow: var(--shadow);
      padding: 26px 22px 16px 22px;
      border: 1.4px solid var(--primary-light);
      display: flex;
      flex-direction: column;
      min-width: 0;
      position: relative;
      min-height: 180px;
      transition: box-shadow 0.15s, border 0.13s, background 0.12s, transform 0.13s;
      word-break: break-word;
      backdrop-filter: blur(12px) saturate(1.1);
    }
    .project-card:hover {
      box-shadow: 0 8px 36px #ff6ccc22, 0 2px 10px #70a1d755;
      background: rgba(255,255,255,0.93);
      border-color: var(--primary2);
      transform: scale(1.018);
    }
    .project-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 4px;
      position: relative;
    }
    .project-title {
      font-size: 1.19rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
      letter-spacing: 0.01em;
      color: #2d1f46;
    }
    .project-title .dot {
      margin-top: 2px;
    }
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 2px;
      display: inline-block;
      vertical-align: middle;
    }
    .dot.blue { background: #4f8ef9; }
    .dot.purple { background: #c3a6fa; }
    .dot.green { background: #42c167; }
    .dot.orange { background: #f4a72d; }
    .dot.teal { background: #37cdb7; }
    .status-badge {
      margin-left: 10px;
      padding: 3px 15px;
      border-radius: 11px;
      font-size: 1.04rem;
      font-weight: 600;
      text-transform: lowercase;
      background: #e4e8f7;
      color: #5d8ffd;
      display: inline-block;
      vertical-align: middle;
      letter-spacing: 0.03em;
      border: 1.5px solid #d2d2fe;
      box-shadow: 0 1px 8px #885af822;
    }
    .status-badge.inprogress {
      background: #e9f2fe;
      color: #357bff;
      border: 1.5px solid #b0d6ff;
    }
    .status-badge.completed {
      background: #d9f7e8;
      color: #19b35a;
      border: 1.5px solid #9be8c7;
    }
    .status-badge.planning {
      background: #fdf6eb;
      color: #eaa13c;
      border: 1.5px solid #ffe1ab;
    }
    .status-badge.review {
      background: #f4eafc;
      color: #ae6ae7;
      border: 1.5px solid #e2c7fc;
    }
    .project-menu-btn {
      background: none;
      border: none;
      color: #a8a8a8;
      font-size: 1.23rem;
      padding: 4px;
      border-radius: 7px;
      cursor: pointer;
      transition: background var(--transition), color 0.14s;
      position: relative;
    }
    .project-menu-btn:focus {
      outline: 2px solid var(--primary2);
    }
    .project-menu-btn.active {
      background: #eae4fb;
      color: var(--primary2);
    }
    .project-menu-dropdown {
      position: absolute;
      top: 36px;
      right: 0;
      background: #fff;
      border: 1.5px solid var(--primary-light);
      border-radius: 12px;
      box-shadow: var(--shadow);
      min-width: 170px;
      z-index: 30;
      padding: 8px 0;
      display: none;
      flex-direction: column;
      animation: fadeIn 0.15s;
    }
    .project-menu-dropdown.show {
      display: flex;
    }
    .project-menu-dropdown button {
      background: none;
      border: none;
      padding: 12px 20px;
      width: 100%;
      text-align: left;
      font-size: 1.07rem;
      color: #444;
      cursor: pointer;
      transition: background 0.15s, color 0.13s;
      font-family: inherit;
      outline: none;
    }
    .project-menu-dropdown button:hover {
      background: #f4f2f8;
      color: var(--primary2);
    }
    .project-card.completed .project-title,
    .project-card.completed .project-desc {
      text-decoration: line-through;
      opacity: 0.6;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-7px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .priority {
      font-weight: 700;
      font-size: 1.07rem;
      margin-top: 9px;
    }
    .priority.high { color: var(--danger);}
    .priority.medium { color: #e9933a;}
    .priority.low { color: #19b35a;}
    .progress-row {
      display: flex;
      align-items: center;
      gap: 13px;
      margin-top: 13px;
      margin-bottom: 7px;
    }
    .progress-label {
      font-size: 1.01rem;
      color: var(--gray-dark);
      font-weight: 500;
    }
    .progress-bar-bg {
      flex: 1 1 30px;
      height: 12px;
      background: #f3f0fa;
      border-radius: 8px;
      overflow: hidden;
      margin: 0 7px;
      box-shadow: 0 1px 4px #885af81a;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--primary2));
      border-radius: 8px;
      transition: width 0.22s cubic-bezier(.5,.33,.26,.86);
      box-shadow: 0 1px 6px #885af822;
    }
    .progress-perc {
      font-size: 1.01rem;
      font-weight: 700;
      color: var(--primary2);
    }
    .project-meta {
      margin-top: 11px;
      display: flex;
      gap: 24px;
      font-size: 1.01rem;
      color: #7c4ef7;
      font-weight: 600;
    }
    .icon {
      margin-right: 4px;
      vertical-align: middle;
    }

    /* --------- Responsive Mobile --------- */
    @media (max-width: 950px) {
      .sidebar {
        left: -290px;
        width: 80vw;
        min-width: 220px;
        max-width: 330px;
        height: 100vh;
        padding: 22px 12px 14px 12px;
        font-size: 1rem;
      }
      .sidebar.open {
        left: 0;
      }
      .hamburger {
        display: flex;
      }
      .main {
        margin-left: 0;
      }
      .main-content {
        padding: 18px 6vw 32px 6vw;
      }
      .topbar {
        padding: 22px 6vw 0 6vw;
        min-height: 64px;
      }
      .projects-title { font-size: 1.45rem; }
      .projects-title-icon { width: 34px; height: 34px; font-size: 1.2rem;}
      .stats-row { gap: 12px; }
      .stat-card { padding: 16px 10px 12px 13px; font-size: 0.97rem; }
      .stat-icon { font-size: 1.1rem; padding: 8px; }
      .sidebar .logo { margin-bottom: 22px;}
    }

    @media (max-width: 700px) {
      html, body { font-size: 15px;}
      .container {
        flex-direction: column;
        width: 100vw;
        max-width: 100vw;
        min-width: 0;
      }
      .main-content {
        padding: 10px 2vw 28px 2vw;
      }
      .topbar {
        flex-direction: column;
        align-items: stretch;
        padding: 14px 2vw 0 2vw;
        min-height: 48px;
        gap: 10px;
      }
      .topbar-left { gap: 8px; }
      .search-bar input { font-size: 1rem; padding:10px 36px 10px 12px;}
      .sidebar {
        width: 92vw;
        min-width: 0;
        max-width: 99vw;
        padding: 16px 6px 8px 10px;
        font-size: 0.98rem;
      }
      .projects-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
        margin-bottom: 15px;
      }
      .projects-title {
        font-size: 1.15rem;
        gap: 10px;
      }
      .projects-title-icon {
        width: 24px;
        height: 24px;
        font-size: 1rem;
      }
      .new-project-btn {
        font-size: 1.05rem;
        padding: 8px 22px;
        margin-left: 0;
        margin-top: 7px;
        border-radius: 0.7em;
      }
      .stats-row {
        flex-direction: column;
        gap: 8px;
        margin-bottom: 18px;
        width: 100%;
      }
      .stat-card {
        min-width: 0;
        flex: 1 1 80px;
        width: 100%;
        box-sizing: border-box;
        padding: 10px 7px 7px 9px;
        font-size: 0.93rem;
      }
      .stat-label, .stat-value { font-size: 1.02rem;}
      .projects-grid {
        grid-template-columns: 1fr !important;
        gap: 12px;
        margin-top: 7px;
      }
      .project-card {
        padding: 13px 8px 10px 10px;
        min-height: 110px;
        font-size: 0.97rem;
      }
      .project-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }
      .project-title { font-size: 1.03rem; gap: 5px;}
      .project-meta { gap: 10px; font-size: 0.95rem;}
      .progress-row { gap: 5px; margin-top: 8px; margin-bottom: 3px; }
      .priority { margin-top: 3px; font-size: 0.97rem;}
      #modalBox {
        max-width: 96vw !important;
        margin: 36px auto 0 auto !important;
        padding: 18px 8px 15px 8px !important;
        border-radius: 0.9em !important;
      }
      #modalBox h2 {
        font-size: 1.03rem !important;
        margin-bottom: 10px !important;
      }
      #modalBox input,
      #modalBox textarea,
      #modalBox select {
        font-size: 0.99rem !important;
        padding: 8px 6px !important;
      }
      #modalBox button#createProjectBtn {
        font-size: 0.99rem !important;
        padding: 10px 0 !important;
        margin-top: 7px !important;
      }
      #closeModalBtn {
        top: 6px !important;
        right: 5px !important;
        font-size: 1.1rem !important;
      }
    }

    @media (max-width: 500px) {
      html, body { font-size: 14px;}
      .sidebar {
        width: 99vw;
        min-width: 0;
        max-width: 100vw;
        padding: 10px 2px 4px 3px;
      }
      .main-content { padding: 4vw 1vw 14vw 1vw;}
      .topbar { padding: 6vw 1vw 0 1vw;}
      #modalBox {
        padding: 10px 2px 8px 2px !important;
      }
    }
    ::-webkit-scrollbar { width: 8px; background: #f4f3fa;}
    ::-webkit-scrollbar-thumb { background: #ede9fe; border-radius: 16px;}
    ::-webkit-scrollbar-thumb:hover { background: #d1c4e9; }
    ::selection { background: #ede9fe;}
  </style>
</head>
<body>
  <button class="hamburger" id="hamburgerBtn" aria-label="Open menu">
    <span class="hamburger-icon">
      <span class="hamburger-bar"></span>
      <span class="hamburger-bar"></span>
      <span class="hamburger-bar"></span>
    </span>
  </button>
  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div>
        <div class="logo">
          <span class="logo-icon"><svg width="21" height="21" fill="none"><rect x="1" y="1" width="19" height="19" rx="5" fill="#fff"/><rect x="1" y="1" width="19" height="19" rx="5" stroke="#885af8" stroke-width="2"/><rect x="6" y="6" width="9" height="9" rx="2" fill="#885af8"/></svg></span>
          <span class="logo-text">TaskFlows</span>
        </div>
        <div class="nav-section">
          <div class="nav-title">WORKSPACE</div>
          <ul class="nav">
            <li class="nav-item"><a href="text-editor.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">📝</span>Text Editor</a></li>
            <li class="nav-item"><a href="to-do-list.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">✅</span>To-Do Lists</a></li>
            <li class="nav-item selected" data-page="projects"><span class="nav-icon">📊</span>Dashboard</li>
            <li class="nav-item"><a href="notes.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">🗒️</span>Notes</a></li>
            <li class="nav-item"><a href="whiteboard.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">🖊️</span>Whiteboard</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <div class="nav-title">PERSONAL</div>
          <ul class="nav">
              <li class="nav-item"><a href="lists.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">📋</span>Lists</a></li>
            <li class="nav-item"><a href="journal.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">📓</span>Journal</a></li>
            <li class="nav-item"><a href="quicknotes.html" style="text-decoration:none; color:inherit; display:flex; align-items:center;"><span class="nav-icon">✏️</span>Quick Notes</a></li>
          </ul>
        </div>
      </div>
      <div>
        <div class="settings-link" data-page="settings">
          <span class="nav-icon">⚙️</span>Settings
        </div>
      </div>
    </aside>
    <!-- Main -->
    <div class="main">
      <!-- Topbar -->
      <div class="topbar">
        <div class="topbar-left">
          <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search tasks, notes, projects…">
            <span class="search-icon">🔍</span>
          </div>
        </div>
        <div class="topbar-right"></div>
      </div>
      <!-- Main Content -->
      <div class="main-content" id="mainContent">
        <!-- Projects Page (Home) -->
        <div id="projectsPage">
          <div class="projects-header">
            <div>
              <span class="projects-title">
                <span class="projects-title-icon"><svg width="30" height="30" fill="none"><rect x="3" y="3" width="24" height="24" rx="7" fill="#f5f2fe"/><rect x="8" y="8" width="14" height="14" rx="4" fill="#885af8"/></svg></span>
                Projects
              </span>
              <div class="projects-desc">Manage and track your project progress</div>
            </div>
            <button class="new-project-btn" id="newProjectBtn"><span>＋</span> New Project</button>
          </div>
          <div class="stats-row">
            <div class="stat-card">
              <div class="stat-icon"><span>📊</span></div>
              <div class="stat-content">
                <div class="stat-label">Total Projects</div>
                <div class="stat-value" id="statTotalProjects">0</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon clock"><span>⏲️</span></div>
              <div class="stat-content">
                <div class="stat-label">In Progress</div>
                <div class="stat-value" id="statInProgress">0</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon check"><span>✔️</span></div>
              <div class="stat-content">
                <div class="stat-label">Completed</div>
                <div class="stat-value" id="statCompleted">0</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon trend"><span>📈</span></div>
              <div class="stat-content">
                <div class="stat-label">Avg Progress</div>
                <div class="stat-value orange" id="statAvgProgress">0%</div>
              </div>
            </div>
          </div>
          <div class="projects-grid" id="projectsGrid">
            <!-- Project Cards will be injected here -->
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal for New Project -->
  <div id="modalOverlay" style="display:none; position:fixed; z-index:99999; top:0; left:0; width:100vw; height:100vh; background:rgba(26,32,44,0.16); align-items:center; justify-content:center;">
    <div id="modalBox" style="background:var(--glass);border-radius:1.2em;max-width:400px;margin:100px auto 0 auto;padding:34px 30px 30px 30px;box-shadow:var(--shadow);position:relative;backdrop-filter:blur(13px) saturate(1.2);border:1.7px solid var(--primary2);">
      <button id="closeModalBtn" style="position:absolute;top:13px;right:12px;border:none;background:none;font-size:1.3rem;cursor:pointer;color:var(--gray);">✕</button>
      <h2 style="font-size:1.35rem; font-weight:700; margin-bottom:22px;">Create New Project</h2>
      <div style="display:flex;flex-direction:column;gap:18px;">
        <input id="newProjectTitle" type="text" placeholder="Project Title" style="padding:11px 12px;border-radius:8px;border:1.4px solid var(--primary2);font-size:1.09rem;">
        <textarea id="newProjectDesc" placeholder="Description" style="padding:11px 12px;border-radius:8px;border:1.4px solid var(--primary2);font-size:1.09rem;min-height:60px;"></textarea>
        <select id="newProjectStatus" style="padding:11px 12px;border-radius:8px;border:1.4px solid var(--primary2);font-size:1.09rem;">
          <option value="planning">Planning</option>
          <option value="in progress">In Progress</option>
          <option value="review">Review</option>
          <option value="completed">Completed</option>
        </select>
        <input id="newProjectEndDate" type="date" style="padding:11px 12px;border-radius:8px;border:1.4px solid var(--primary2);font-size:1.09rem;">
        <input id="newProjectMembers" type="number" min="1" max="99" placeholder="Team Members" style="padding:11px 12px;border-radius:8px;border:1.4px solid var(--primary2);font-size:1.09rem;">
        <select id="newProjectPriority" style="padding:11px 12px;border-radius:8px;border:1.4px solid var(--primary2);font-size:1.09rem;">
          <option value="high">High Priority</option>
          <option value="medium">Medium Priority</option>
          <option value="low">Low Priority</option>
        </select>
        <button id="createProjectBtn" style="background:linear-gradient(90deg, var(--primary2), var(--primary));color:#fff;padding:13px 0;border:none;border-radius:8px;font-size:1.11rem;font-weight:700;margin-top:10px;cursor:pointer;letter-spacing:0.08em;box-shadow:0 2px 12px #885af830;">Create Project</button>
      </div>
    </div>
  </div>
  <script>
    // Hamburger menu logic
    const sidebar = document.getElementById('sidebar');
    const hamburgerBtn = document.getElementById('hamburgerBtn');

 function openSidebar() {
  sidebar.classList.add('open');
  sidebar.classList.remove('hide');
  if(window.innerWidth <= 950) sidebar.style.display = 'flex';
}
function closeSidebar() {
  sidebar.classList.remove('open');
  sidebar.classList.add('hide');
  if(window.innerWidth <= 950) sidebar.style.display = 'none';
}
  
    function toggleSidebar() {
      if (sidebar.classList.contains('open')) {
        closeSidebar();
      } else {
        openSidebar();
      }
    }
    function handleSidebarOnResize() {
      if (window.innerWidth <= 950) {
        closeSidebar();
        hamburgerBtn.style.display = 'flex';
      } else {
        sidebar.classList.remove('hide');
        sidebar.classList.remove('open');
        hamburgerBtn.style.display = 'none';
      }
    }
    window.addEventListener('resize', handleSidebarOnResize);
    handleSidebarOnResize();
    hamburgerBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      toggleSidebar();
    });
    document.addEventListener('click', function(e) {
      if (
        window.innerWidth <= 950 &&
        sidebar.classList.contains('open') &&
        !sidebar.contains(e.target) &&
        !hamburgerBtn.contains(e.target)
      ) {
        closeSidebar();
      }
    });
    sidebar.addEventListener('click', function(e) {
      if (
        (e.target.tagName === 'A' || e.target.classList.contains('nav-item'))
        && window.innerWidth <= 950
      ) {
        closeSidebar();
      }
    });

    // ---- TaskFlows JS (projects, modal, etc) ----
    const PROJECTS_KEY = 'taskflows-projects';
    let projectsData = JSON.parse(localStorage.getItem(PROJECTS_KEY) || '[]');

    const statusBadges = {
      "in progress": { text: "in progress", class: "status-badge inprogress" },
      "planning": { text: "planning", class: "status-badge planning" },
      "review": { text: "review", class: "status-badge review" },
      "completed": { text: "completed", class: "status-badge completed" }
    };
    const statusColorDots = {
      "blue": "dot blue",
      "purple": "dot purple",
      "green": "dot green",
      "orange": "dot orange",
      "teal": "dot teal"
    };
    const priorityText = {
      "high": "HIGH PRIORITY",
      "medium": "MEDIUM PRIORITY",
      "low": "LOW PRIORITY"
    };
    const priorityClass = {
      "high": "priority high",
      "medium": "priority medium",
      "low": "priority low"
    };

    function renderProjects(projects) {
      const grid = document.getElementById('projectsGrid');
      grid.innerHTML = '';
      projects.forEach((p, idx) => {
        let badge = statusBadges[p.status] || statusBadges["planning"];
        let dotClass = statusColorDots[p.statusColor] || statusColorDots["blue"];
        let priority = priorityText[p.priority] || "";
        let priorityCls = priorityClass[p.priority] || "";
        let completedClass = p.status === "completed" ? "completed" : "";
        grid.innerHTML += `
        <div class="project-card ${completedClass}" data-idx="${idx}">
          <div class="project-header">
            <span class="project-title">
              <span class="${dotClass}"></span>
              <span>${p.title}</span>
            </span>
            <span class="${badge.class}" style="margin-top:2px; margin-left:8px;">${badge.text}</span>
            <button class="project-menu-btn" tabindex="0" aria-label="Show menu">⋯</button>
            <div class="project-menu-dropdown">
              <button class="complete-btn">${p.status !== "completed" ? "Mark as Completed" : "Mark as In Progress"}</button>
              <button class="duplicate-btn">Duplicate Project</button>
              <button class="delete-btn" style="color:#ff5449;">Delete Project</button>
            </div>
          </div>
          <div class="project-desc">${p.desc}</div>
          <div class="progress-row">
            <span class="progress-label">Progress</span>
            <span class="progress-bar-bg">
              <span class="progress-bar" style="width:${Math.max(0,Math.min(100,p.progress))}%;"></span>
            </span>
            <span class="progress-perc">${p.progress}%</span>
          </div>
          <div class="project-meta">
            <span><span class="icon">👥</span>${p.members} member${p.members>1?'s':''}</span>
            <span><span class="icon">📅</span>${p.endDate?formatDate(p.endDate):"--"}</span>
          </div>
          <div class="${priorityCls}" style="margin-bottom:-2px;">${priority}</div>
        </div>
        `;
      });
      attachProjectMenus();
    }

    function formatDate(dateStr) {
      if(!dateStr) return "--";
      const d = new Date(dateStr);
      if (isNaN(d.getTime())) return dateStr;
      return `${d.getMonth()+1}/${d.getDate()}/${d.getFullYear()}`;
    }

    function updateStats() {
      const total = projectsData.length;
      const inProgress = projectsData.filter(p=>p.status==="in progress").length;
      const completed = projectsData.filter(p=>p.status==="completed").length;
      const avg = total ? Math.round(projectsData.reduce((a,p)=>a+p.progress,0)/total) : 0;
      document.getElementById('statTotalProjects').textContent = total;
      document.getElementById('statInProgress').textContent = inProgress;
      document.getElementById('statCompleted').textContent = completed;
      document.getElementById('statAvgProgress').textContent = avg + "%";
      document.getElementById('statAvgProgress').className = "stat-value orange";
    }

    function saveProjects() {
      localStorage.setItem(PROJECTS_KEY, JSON.stringify(projectsData));
    }

    document.querySelectorAll('.nav-item[data-page]').forEach(item => {
      item.addEventListener('click', function(e) {
        if (e.target.tagName === "A") return;
        document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('selected'));
        this.classList.add('selected');
        const page = this.getAttribute('data-page');
        showPage(page);
      });
    });
    document.querySelector('.settings-link').addEventListener('click', function() {
      document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('selected'));
      showPage('settings');
    });

    function showPage(page) {
      const mc = document.getElementById('mainContent');
      if (page === "projects") {
        mc.innerHTML = document.getElementById('projectsPage').outerHTML;
        renderProjects(projectsData);
        updateStats();
        attachMainEvents();
      } else {
        mc.innerHTML = `<div style="padding:60px 0;text-align:center; font-size:2rem; color:#9ba3af;">${capitalize(page)} page coming soon.</div>`;
      }
    }
    function capitalize(str){ return str.charAt(0).toUpperCase()+str.slice(1); }

    function showModal() {
      document.getElementById('modalOverlay').style.display = '';
      document.getElementById('newProjectTitle').focus();
    }
    function hideModal() {
      document.getElementById('modalOverlay').style.display = 'none';
      document.getElementById('newProjectTitle').value='';
      document.getElementById('newProjectDesc').value='';
      document.getElementById('newProjectStatus').value='planning';
      document.getElementById('newProjectEndDate').value='';
      document.getElementById('newProjectMembers').value='';
      document.getElementById('newProjectPriority').value='high';
    }
    document.getElementById('newProjectBtn').addEventListener('click', showModal);
    document.getElementById('closeModalBtn').addEventListener('click', hideModal);
    document.getElementById('modalOverlay').addEventListener('click', function(e){
      if(e.target===this) hideModal();
    });
    document.getElementById('createProjectBtn').addEventListener('click', function() {
      const title = document.getElementById('newProjectTitle').value.trim();
      const desc = document.getElementById('newProjectDesc').value.trim();
      const status = document.getElementById('newProjectStatus').value;
      const endDate = document.getElementById('newProjectEndDate').value;
      const members = parseInt(document.getElementById('newProjectMembers').value,10) || 1;
      const priority = document.getElementById('newProjectPriority').value;
      if (!title) { alert("Project title is required."); return; }
      projectsData.push({
        title, status, desc,
        statusColor: (status==="in progress")?"blue":(status==="planning"?"purple":(status==="review"?"green":"orange")),
        badge: status,
        progress: (status==="completed")?100:0,
        members, endDate, priority
      });
      saveProjects();
      renderProjects(projectsData);
      updateStats();
      hideModal();
    });

    document.getElementById('searchInput').addEventListener('input', function() {
      const val = this.value.toLowerCase();
      const filtered = projectsData.filter(p =>
        p.title.toLowerCase().includes(val) ||
        p.desc.toLowerCase().includes(val)
      );
      renderProjects(filtered);
      updateStats();
    });

    function attachMainEvents() {
      if(document.getElementById('newProjectBtn')){
        document.getElementById('newProjectBtn').addEventListener('click', showModal);
      }
      if(document.getElementById('closeModalBtn')){
        document.getElementById('closeModalBtn').addEventListener('click', hideModal);
      }
      if(document.getElementById('createProjectBtn')){
        document.getElementById('createProjectBtn').addEventListener('click', function() {
          const title = document.getElementById('newProjectTitle').value.trim();
          const desc = document.getElementById('newProjectDesc').value.trim();
          const status = document.getElementById('newProjectStatus').value;
          const endDate = document.getElementById('newProjectEndDate').value;
          const members = parseInt(document.getElementById('newProjectMembers').value,10) || 1;
          const priority = document.getElementById('newProjectPriority').value;
          if (!title) { alert("Project title is required."); return; }
          projectsData.push({
            title, status, desc,
            statusColor: (status==="in progress")?"blue":(status==="planning"?"purple":(status==="review"?"green":"orange")),
            badge: status,
            progress: (status==="completed")?100:0,
            members, endDate, priority
          });
          saveProjects();
          renderProjects(projectsData);
          updateStats();
          hideModal();
        });
      }
      if(document.getElementById('modalOverlay')){
        document.getElementById('modalOverlay').addEventListener('click', function(e){
          if(e.target===this) hideModal();
        });
      }
      attachProjectMenus();
    }

    function attachProjectMenus() {
      document.querySelectorAll('.project-menu-btn').forEach((menuBtn, idx) => {
        const card = menuBtn.closest('.project-card');
        const dropdown = card.querySelector('.project-menu-dropdown');

        // Only one menu open at a time
        menuBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          // If this menu is already open, close it
          const isOpen = dropdown.classList.contains('show');
          document.querySelectorAll('.project-menu-dropdown').forEach(d => d.classList.remove('show'));
          document.querySelectorAll('.project-menu-btn').forEach(btn => btn.classList.remove('active'));
          if (!isOpen) {
            dropdown.classList.add('show');
            menuBtn.classList.add('active');
          } else {
            dropdown.classList.remove('show');
            menuBtn.classList.remove('active');
          }
        });

        // Close menu on outside click (mobile & desktop)
        document.addEventListener('click', function hideDropdowns(e) {
          if (!dropdown.contains(e.target) && !menuBtn.contains(e.target)) {
            dropdown.classList.remove('show');
            menuBtn.classList.remove('active');
          }
        });

        // Menu actions
        const completeBtn = card.querySelector('.complete-btn');
        const duplicateBtn = card.querySelector('.duplicate-btn');
        const deleteBtn = card.querySelector('.delete-btn');
        completeBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          if (projectsData[idx].status !== "completed") {
            projectsData[idx].status = "completed";
            projectsData[idx].progress = 100;
            projectsData[idx].statusColor = "orange";
          } else {
            projectsData[idx].status = "in progress";
            projectsData[idx].progress = 0;
            projectsData[idx].statusColor = "blue";
          }
          saveProjects();
          renderProjects(projectsData);
          updateStats();
        });
        duplicateBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          const proj = projectsData[idx];
          const copy = {...proj};
          copy.title = proj.title + " (Copy)";
          if (copy.status === "completed") {
            copy.status = "planning";
            copy.progress = 0;
            copy.statusColor = "purple";
          }
          projectsData.push(copy);
          saveProjects();
          renderProjects(projectsData);
          updateStats();
        });
        deleteBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          if (confirm("Delete this project?")) {
            projectsData.splice(idx, 1);
            saveProjects();
            renderProjects(projectsData);
            updateStats();
          }
        });
      });
    }
    

    renderProjects(projectsData);
    updateStats();

    renderProjects(projectsData);
    updateStats();
  </script>
</body>
</html>
