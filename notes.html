<!DOCTYPE html>
<html lang="en">

<head>
  <!DOCTYPE html>
  <html lang="en">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RQR9BDLJ26"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-RQR9BDLJ26');
  </script>

  <head>
    <meta charset="UTF-8" />
    <title>TaskFlows ¬∑ Notes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="Untitled-removebg-preview.png" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
      :root {
        --bg: #f5f5f7;
        --bg-soft: #ffffff;
        --bg-soft-alt: #f9fafb;
        --border-subtle: #e5e7eb;
        --border-strong: #d1d5db;
        --accent: #ef4444;
        --accent-soft: rgba(239, 68, 68, 0.08);
        --accent-border: rgba(239, 68, 68, 0.55);
        --text: #111827;
        --text-soft: #6b7280;
        --text-softer: #9ca3af;
        --radius-lg: 14px;
        --radius-xl: 18px;
        --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.06);
        --transition-fast: 140ms ease-out;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
      }

      body {
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg);
        color: var(--text);
        -webkit-font-smoothing: antialiased;
      }

      .app {
        display: flex;
        min-height: 100vh;
        width: 100%;
        background: var(--bg);
      }

      /* SIDEBAR */
      .sidebar {
        width: 250px;
        background: #ffffff;
        border-right: 1px solid #e5e7eb;
        padding: 16px 14px 18px;
        display: flex;
        flex-direction: column;
        gap: 18px;
      }

      .sidebar-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
      }

      .logo-pill {
        width: 30px;
        height: 30px;
        border-radius: 999px;
        background: #111827;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: 700;
        color: #f9fafb;
      }

      .logo-text-main {
        font-weight: 600;
        font-size: 15px;
        letter-spacing: 0.02em;
      }

      .logo-text-sub {
        font-size: 11px;
        color: var(--text-soft);
      }

      .workspace-chip {
        font-size: 11px;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: var(--bg-soft-alt);
        color: var(--text-soft);
        display: inline-flex;
        align-items: center;
        gap: 4px;
      }

      .sidebar-section {
        margin-top: 4px;
      }

      .sidebar-title {
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: var(--text-softer);
        margin-bottom: 6px;
        padding: 0 4px;
      }

      .nav-group {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .nav-item {
        border: none;
        background: transparent;
        color: var(--text-soft);
        font-size: 13px;
        padding: 6px 10px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        gap: 8px;
        cursor: pointer;
        transition: background var(--transition-fast), color var(--transition-fast), transform 70ms ease-out;
      }

      .nav-emoji {
        font-size: 15px;
      }

      .nav-label {
        font-size: 13px;
      }

      .nav-item:hover {
        background: #f3f4f6;
        color: #111827;
        transform: translateY(-1px);
      }

      .nav-item.active {
        background: var(--accent-soft);
        color: #b91c1c;
      }

      .sidebar-footer {
        margin-top: auto;
        padding-top: 10px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        flex-direction: column;
        gap: 6px;
        font-size: 11px;
        color: var(--text-softer);
      }

      .sidebar-footer-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .sync-dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: #22c55e;
      }

      /* MAIN */
      .main {
        flex: 1;
        padding: 16px 20px 18px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .top-bar {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .top-title {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .top-title-main {
        font-size: 18px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .top-pill {
        font-size: 11px;
        padding: 3px 8px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        color: var(--text-soft);
        display: inline-flex;
        align-items: center;
        gap: 4px;
        background: #ffffff;
      }

      .top-title-sub {
        font-size: 12px;
        color: var(--text-soft);
      }

      .top-actions {
        margin-left: auto;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .btn {
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #ffffff;
        color: var(--text);
        font-size: 11px;
        padding: 6px 11px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        transition: background var(--transition-fast), border-color var(--transition-fast), transform 70ms ease-out, box-shadow var(--transition-fast);
      }

      .btn span {
        font-size: 14px;
      }

      .btn-primary {
        background: #111827;
        border-color: #111827;
        color: #f9fafb;
      }

      .btn-primary:hover {
        background: #020617;
        border-color: #020617;
        transform: translateY(-1px);
        box-shadow: 0 10px 20px rgba(15, 23, 42, 0.25);
      }

      .btn-ghost {
        background: #ffffff;
      }

      .btn:hover {
        background: #f3f4f6;
        border-color: var(--border-strong);
        transform: translateY(-0.5px);
      }

      .btn-icon-only {
        width: 32px;
        height: 32px;
        padding: 0;
        align-items: center;
        justify-content: center;
      }

      .btn-small {
        padding: 4px 9px;
        font-size: 11px;
      }

      .toolbar {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .toolbar-main {
        flex: 1;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .search {
        flex: 1;
        position: relative;
      }

      .search input {
        width: 100%;
        padding: 7px 11px 7px 26px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #ffffff;
        color: var(--text);
        font-size: 12px;
        outline: none;
        transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast);
      }

      .search input::placeholder {
        color: var(--text-softer);
      }

      .search input:focus {
        border-color: var(--accent-border);
        box-shadow: 0 0 0 1px var(--accent-border);
        background: #ffffff;
      }

      .search-icon {
        position: absolute;
        left: 9px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 13px;
        color: var(--text-softer);
      }

      .chip-group {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        background: #ffffff;
        padding: 2px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
      }

      .chip {
        border-radius: 999px;
        border: none;
        background: transparent;
        font-size: 11px;
        padding: 4px 9px;
        color: var(--text-soft);
        cursor: pointer;
        transition: background var(--transition-fast), color var(--transition-fast), transform 70ms ease-out;
      }

      .chip:hover {
        background: #f3f4f6;
        color: #111827;
      }

      .chip.active {
        background: #111827;
        color: #f9fafb;
      }

      .toolbar-advanced {
        display: none;
        margin-top: 6px;
        display: flex;
        gap: 8px;
        align-items: center;
        font-size: 11px;
      }

      .toolbar-advanced-inner {
        padding: 6px 8px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #ffffff;
        display: inline-flex;
        gap: 8px;
        align-items: center;
      }

      .toolbar-select,
      .toolbar-input {
        font-size: 11px;
        padding: 4px 8px;
        border-radius: 999px;
        border: 1px solid transparent;
        background: #f9fafb;
        color: var(--text-soft);
        outline: none;
        cursor: pointer;
        min-width: 90px;
      }

      .toolbar-input {
        min-width: 0;
        width: 150px;
        cursor: text;
      }

      .toolbar-select:focus,
      .toolbar-input:focus {
        border-color: var(--accent-border);
      }

      .toolbar-advanced-label {
        font-size: 11px;
        color: var(--text-softer);
        margin-left: 2px;
      }

      /* CONTENT */
      .content {
        flex: 1;
        display: grid;
        grid-template-columns: minmax(0, 0.8fr) minmax(0, 1.4fr);
        gap: 12px;
        min-height: 0;
      }

      .panel {
        background: #ffffff;
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-subtle);
        padding: 10px 10px 8px;
        display: flex;
        flex-direction: column;
        min-height: 0;
        box-shadow: var(--shadow-soft);
      }

      .panel-header-compact {
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .panel-header-left {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }

      .panel-title {
        font-size: 12px;
        font-weight: 500;
        color: var(--text-soft);
      }

      .panel-sub {
        font-size: 11px;
        color: var(--text-softer);
      }

      .note-counter {
        font-size: 11px;
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #f9fafb;
        color: var(--text-soft);
      }

      /* NOTES LIST */
      .notes-list {
        overflow-y: auto;
        padding-right: 4px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .notes-list::-webkit-scrollbar {
        width: 4px;
      }

      .notes-list::-webkit-scrollbar-track {
        background: transparent;
      }

      .notes-list::-webkit-scrollbar-thumb {
        background: #d1d5db;
        border-radius: 999px;
      }

      .note-item {
        border-radius: 10px;
        padding: 7px 9px;
        background: #ffffff;
        border: 1px solid var(--border-subtle);
        cursor: pointer;
        display: flex;
        flex-direction: column;
        gap: 4px;
        transition: background var(--transition-fast), border-color var(--transition-fast), transform 70ms ease-out, box-shadow var(--transition-fast);
        position: relative;
      }

      .note-item:hover {
        background: #f9fafb;
        border-color: var(--border-strong);
        transform: translateY(-1px);
        box-shadow: 0 8px 18px rgba(15, 23, 42, 0.04);
      }

      .note-item.active {
        border-color: var(--accent-border);
        background: #fff;
        box-shadow: 0 10px 22px rgba(239, 68, 68, 0.12);
      }

      .note-item-header {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .note-color-dot {
        width: 9px;
        height: 9px;
        border-radius: 999px;
        flex-shrink: 0;
      }

      .note-title {
        font-size: 13px;
        font-weight: 500;
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .note-meta {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 10px;
        color: var(--text-softer);
      }

      .note-pin {
        font-size: 12px;
      }

      .note-preview {
        font-size: 11px;
        color: var(--text-soft);
        line-height: 1.4;
        max-height: 32px;
        overflow: hidden;
      }

      .note-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
        margin-top: 1px;
      }

      .note-tag {
        font-size: 9px;
        padding: 1px 6px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #f9fafb;
        color: var(--text-softer);
        max-width: 110px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .quick-add {
        border-radius: 999px;
        border: 1px dashed var(--border-subtle);
        padding: 6px 9px;
        font-size: 11px;
        color: var(--text-softer);
        background: #f9fafb;
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: text;
      }

      .quick-add span {
        font-size: 13px;
      }

      .quick-add input {
        border: none;
        outline: none;
        background: transparent;
        font-size: 11px;
        flex: 1;
        color: var(--text);
      }

      .quick-add input::placeholder {
        color: var(--text-softer);
      }

      /* EDITOR */
      .editor-wrapper {
        display: flex;
        flex-direction: column;
        gap: 6px;
        flex: 1;
        min-height: 0;
      }

      .editor-top-row {
        display: flex;
        gap: 6px;
      }

      .editor-title-input {
        flex: 1;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #ffffff;
        color: var(--text);
        padding: 7px 12px;
        font-size: 14px;
        font-weight: 500;
        outline: none;
        transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
      }

      .editor-title-input::placeholder {
        color: var(--text-softer);
      }

      .editor-title-input:focus {
        border-color: var(--accent-border);
        box-shadow: 0 0 0 1px var(--accent-border);
      }

      .editor-tag-input {
        width: 190px;
        border-radius: 999px;
        border: 1px dashed var(--border-subtle);
        background: #ffffff;
        color: var(--text);
        padding: 7px 12px;
        font-size: 11px;
        outline: none;
      }

      .editor-tag-input::placeholder {
        color: var(--text-softer);
      }

      .editor-toolbar {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 4px 6px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: #f9fafb;
        font-size: 11px;
        color: var(--text-softer);
      }

      .editor-toolbar-group {
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .editor-toolbar-group+.editor-toolbar-group {
        border-left: 1px solid #e5e7eb;
        padding-left: 6px;
        margin-left: 4px;
      }

      .editor-tool-btn {
        border: none;
        background: transparent;
        color: var(--text-softer);
        font-size: 12px;
        padding: 4px 6px;
        border-radius: 999px;
        cursor: pointer;
        transition: background var(--transition-fast), color var(--transition-fast), transform 70ms ease-out;
      }

      .editor-tool-btn span {
        font-size: 13px;
      }

      .editor-tool-btn:hover {
        background: #e5e7eb;
        color: var(--text);
        transform: translateY(-0.5px);
      }

      .editor-tool-btn.active {
        background: #111827;
        color: #f9fafb;
      }

      .editor-color-dot {
        width: 14px;
        height: 14px;
        border-radius: 999px;
        cursor: pointer;
        transition: transform 70ms ease-out, box-shadow var(--transition-fast);
        border: 1px solid #e5e7eb;
      }

      .editor-color-dot:hover {
        transform: translateY(-0.5px) scale(1.02);
        box-shadow: 0 0 0 2px #e5e7eb;
      }

      .editor-color-dot.active {
        box-shadow: 0 0 0 2px var(--accent-border);
      }

      .editor-main {
        flex: 1;
        margin-top: 4px;
        border-radius: 12px;
        border: 1px solid var(--border-subtle);
        background: #ffffff;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        min-height: 0;
      }

      .editor-textarea {
        flex: 1;
        padding: 10px 12px;
        background: transparent;
        border: none;
        resize: none;
        color: var(--text);
        font-size: 13px;
        line-height: 1.6;
        outline: none;
        min-height: 0;
      }

      .editor-textarea::placeholder {
        color: var(--text-softer);
      }

      .editor-status-bar {
        border-top: 1px solid var(--border-subtle);
        padding: 4px 9px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 11px;
        color: var(--text-softer);
        background: #f9fafb;
      }

      .editor-status-left,
      .editor-status-right {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .status-pill {
        padding: 2px 8px;
        border-radius: 999px;
        background: #ffffff;
        border: 1px solid var(--border-subtle);
      }

      /* EMPTY STATE */
      .empty-state {
        flex: 1;
        border-radius: 10px;
        border: 1px dashed var(--border-subtle);
        background: #f9fafb;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 14px;
        text-align: center;
        font-size: 12px;
        color: var(--text-soft);
      }

      .empty-state span {
        display: block;
        font-size: 18px;
        margin-bottom: 6px;
      }

      /* FOCUS MODE */
      body.focus-mode .sidebar {
        display: none;
      }

      body.focus-mode .content {
        grid-template-columns: minmax(0, 0.7fr) minmax(0, 1.3fr);
      }

      body.focus-mode .main {
        padding-left: 20px;
      }

      /* RESPONSIVE */
      @media (max-width: 960px) {
        .sidebar {
          display: none;
        }

        .content {
          grid-template-columns: 1fr;
        }

        .top-actions {
          display: none;
        }
      }

      @media (max-width: 640px) {
        .toolbar {
          flex-direction: column;
          align-items: stretch;
        }

        .toolbar-main {
          width: 100%;
        }

        .chip-group {
          margin-top: 4px;
        }

        .editor-top-row {
          flex-direction: column;
        }

        .editor-tag-input {
          width: 100%;
        }
      }
    </style>
  </head>

<body>
  <div class="app">
    <!-- SIDEBAR NAV -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo" data-link="dashboard.html">
          <div class="logo-pill">TF</div>
          <div>
            <div class="logo-text-main">TaskFlows</div>
            <div class="logo-text-sub">Personal workspace</div>
          </div>
        </div>
        <div class="workspace-chip">
          <span>‚óè</span>
          Workspace
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Workspace</div>
        <div class="nav-group">
          <button class="nav-item" data-link="text-editor.html">
            <span class="nav-emoji">üìù</span>
            <span class="nav-label">Text Editor</span>
          </button>
          <button class="nav-item" data-link="to-do-list.html">
            <span class="nav-emoji">‚úÖ</span>
            <span class="nav-label">To-Do Lists</span>
          </button>
          <button class="nav-item" data-link="dashboard.html">
            <span class="nav-emoji">üìä</span>
            <span class="nav-label">Dashboard</span>
          </button>
          <button class="nav-item active" data-link="notes.html">
            <span class="nav-emoji">üóíÔ∏è</span>
            <span class="nav-label">Notes</span>
          </button>
          <button class="nav-item" data-link="whiteboard.html">
            <span class="nav-emoji">üñäÔ∏è</span>
            <span class="nav-label">Whiteboard</span>
          </button>
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Personal</div>
        <div class="nav-group">
          <button class="nav-item" data-link="lists.html">
            <span class="nav-emoji">üìã</span>
            <span class="nav-label">Lists</span>
          </button>
          <button class="nav-item" data-link="journal.html">
            <span class="nav-emoji">üìì</span>
            <span class="nav-label">Journal</span>
          </button>
          <button class="nav-item" data-link="quick-notes.html">
            <span class="nav-emoji">‚úèÔ∏è</span>
            <span class="nav-label">Quick Notes</span>
          </button>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="sidebar-footer-row">
          <span>Sync status</span>
          <span class="sync-dot"></span>
        </div>
        <div class="sidebar-footer-row">
          <span>Local backup</span>
          <span>Auto ¬∑ 5s</span>
        </div>
      </div>
    </aside>

    <!-- MAIN AREA -->
    <main class="main">
      <!-- TOP BAR -->
      <div class="top-bar">
        <div class="top-title">
          <div class="top-title-main">
            üóíÔ∏è Notes
            <div class="top-pill">
              <span>‚åò N</span> new note
            </div>
          </div>
          <div class="top-title-sub">
            Minimal notes for everything: ideas, study breakdowns, journals and project docs.
          </div>
        </div>

        <div class="top-actions">
          <button class="btn btn-ghost btn-small" id="focusToggleBtn" title="Toggle focus mode">
            <span>üåì</span> Focus
          </button>
          <button class="btn btn-ghost btn-small" id="pinToggleBtn" title="Pin or unpin current note">
            <span>üìå</span> Pin
          </button>
          <button class="btn btn-ghost btn-small" id="duplicateBtn" title="Duplicate current note">
            <span>üß¨</span> Duplicate
          </button>
          <button class="btn btn-ghost btn-small" id="deleteBtn" title="Archive current note">
            <span>üóëÔ∏è</span> Archive
          </button>
          <button class="btn btn-primary" id="newNoteBtn">
            <span>‚ûï</span> New note
          </button>
        </div>
      </div>

      <!-- TOOLBAR -->
      <div class="toolbar">
        <div class="toolbar-main">
          <div class="search">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Search by title, content, or tags  ¬∑  press / to focus" />
          </div>
          <div class="chip-group">
            <button class="chip active" id="chipAll">All</button>
            <button class="chip" id="chipPinned">Pinned</button>
            <button class="chip" id="chipToday">Today</button>
          </div>
        </div>
        <button class="btn btn-ghost btn-small" id="filtersToggleBtn">
          <span>‚öôÔ∏è</span> Filters
        </button>
      </div>

      <div class="toolbar-advanced" id="toolbarAdvanced" style="display: none;">
        <span class="toolbar-advanced-label">View options</span>
        <div class="toolbar-advanced-inner">
          <select id="sortSelect" class="toolbar-select">
            <option value="recent">Sort ¬∑ Recent</option>
            <option value="az">Sort ¬∑ A ‚Üí Z</option>
            <option value="za">Sort ¬∑ Z ‚Üí A</option>
            <option value="pinned">Sort ¬∑ Pinned first</option>
          </select>
          <select id="filterPinnedSelect" class="toolbar-select">
            <option value="all">All notes</option>
            <option value="pinned">Pinned only</option>
            <option value="normal">Unpinned only</option>
          </select>
          <input type="text" id="filterTagInput" class="toolbar-input" placeholder="Filter by tag (eg: school)" />
        </div>
      </div>

      <!-- CONTENT -->
      <div class="content">
        <!-- LEFT: NOTES LIST -->
        <section class="panel">
          <div class="panel-header-compact">
            <div class="panel-header-left">
              <div class="panel-title">Your notes</div>
              <div class="panel-sub" id="listSubLabel">Pinned first ¬∑ Local only</div>
            </div>
            <div class="note-counter">
              <span id="noteCount">0</span> notes
            </div>
          </div>

          <div class="quick-add">
            <span>‚ûï</span>
            <input id="quickAddInput" placeholder="Quick capture a new note title and press Enter" />
          </div>

          <div class="notes-list" id="notesList"></div>
        </section>

        <!-- RIGHT: EDITOR -->
        <section class="panel">
          <div class="panel-header-compact">
            <div class="panel-header-left">
              <div class="panel-title">Editor</div>
              <div class="panel-sub" id="editorSubLabel">Select a note or create a new one</div>
            </div>
          </div>

          <div class="editor-wrapper" id="editorWrapper">
            <div class="editor-top-row">
              <input type="text" id="noteTitleInput" class="editor-title-input" placeholder="Note title" />
              <input type="text" id="noteTagsInput" class="editor-tag-input" placeholder="Tags (comma separated)" />
            </div>

            <div class="editor-toolbar">
              <div class="editor-toolbar-group">
                <button class="editor-tool-btn" id="smallSizeBtn" title="Small text">
                  A
                </button>
                <button class="editor-tool-btn active" id="mediumSizeBtn" title="Medium text">
                  A
                </button>
                <button class="editor-tool-btn" id="largeSizeBtn" title="Large text">
                  A
                </button>
              </div>

              <div class="editor-toolbar-group">
                <button class="editor-tool-btn" id="wrapToggleBtn" title="Toggle line wrap">
                  <span>‚ÜîÔ∏è</span>
                </button>
                <button class="editor-tool-btn" id="statsToggleBtn" title="Toggle stats">
                  <span>üìä</span>
                </button>
              </div>

              <div class="editor-toolbar-group">
                <span class="panel-sub">Color</span>
                <div class="editor-color-dot active" data-color="#f97373" style="background:#f97373"></div>
                <div class="editor-color-dot" data-color="#38bdf8" style="background:#38bdf8"></div>
                <div class="editor-color-dot" data-color="#a855f7" style="background:#a855f7"></div>
                <div class="editor-color-dot" data-color="#22c55e" style="background:#22c55e"></div>
              </div>

              <div class="editor-toolbar-group">
                <button class="editor-tool-btn" id="templateStudyBtn" title="Insert study template">
                  üìö
                </button>
                <button class="editor-tool-btn" id="templateJournalBtn" title="Insert journal template">
                  üìì
                </button>
                <button class="editor-tool-btn" id="templateMeetingBtn" title="Insert meeting template">
                  üë•
                </button>
              </div>
            </div>

            <div class="editor-main">
              <textarea id="noteContentInput" class="editor-textarea" placeholder="Start typing your note here...

Tips:
‚Ä¢ ‚åò N / Ctrl N to create a note
‚Ä¢ ‚åò S / Ctrl S to force save
‚Ä¢ / to jump to search
‚Ä¢ Double click a note to pin or unpin it"></textarea>
              <div class="editor-status-bar">
                <div class="editor-status-left">
                  <div class="status-pill" id="wordCountLabel">0 words</div>
                  <div class="status-pill" id="charCountLabel">0 chars</div>
                  <div class="status-pill" id="readTimeLabel">0 min read</div>
                </div>
                <div class="editor-status-right">
                  <span id="lastSavedLabel">Not saved yet</span>
                </div>
              </div>
            </div>
          </div>

          <div class="empty-state" id="emptyState" style="display: none;">
            <div>
              <span>üóíÔ∏è</span>
              No note selected yet. Click <strong>New note</strong> or pick one from the list on the left.
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    (function () {
      const STORAGE_KEY = "taskflows_notes_v2";

      const notesListEl = document.getElementById("notesList");
      const noteCountEl = document.getElementById("noteCount");
      const noteTitleInput = document.getElementById("noteTitleInput");
      const noteTagsInput = document.getElementById("noteTagsInput");
      const noteContentInput = document.getElementById("noteContentInput");
      const wordCountLabel = document.getElementById("wordCountLabel");
      const charCountLabel = document.getElementById("charCountLabel");
      const readTimeLabel = document.getElementById("readTimeLabel");
      const lastSavedLabel = document.getElementById("lastSavedLabel");
      const editorWrapper = document.getElementById("editorWrapper");
      const emptyState = document.getElementById("emptyState");
      const editorSubLabel = document.getElementById("editorSubLabel");
      const listSubLabel = document.getElementById("listSubLabel");
      const quickAddInput = document.getElementById("quickAddInput");

      const newNoteBtn = document.getElementById("newNoteBtn");
      const deleteBtn = document.getElementById("deleteBtn");
      const duplicateBtn = document.getElementById("duplicateBtn");
      const pinToggleBtn = document.getElementById("pinToggleBtn");
      const focusToggleBtn = document.getElementById("focusToggleBtn");

      const searchInput = document.getElementById("searchInput");
      const sortSelect = document.getElementById("sortSelect");
      const filterPinnedSelect = document.getElementById("filterPinnedSelect");
      const filterTagInput = document.getElementById("filterTagInput");
      const filtersToggleBtn = document.getElementById("filtersToggleBtn");
      const toolbarAdvanced = document.getElementById("toolbarAdvanced");

      const smallSizeBtn = document.getElementById("smallSizeBtn");
      const mediumSizeBtn = document.getElementById("mediumSizeBtn");
      const largeSizeBtn = document.getElementById("largeSizeBtn");
      const wrapToggleBtn = document.getElementById("wrapToggleBtn");
      const statsToggleBtn = document.getElementById("statsToggleBtn");
      const colorDots = document.querySelectorAll(".editor-color-dot");

      const templateStudyBtn = document.getElementById("templateStudyBtn");
      const templateJournalBtn = document.getElementById("templateJournalBtn");
      const templateMeetingBtn = document.getElementById("templateMeetingBtn");

      const chipAll = document.getElementById("chipAll");
      const chipPinned = document.getElementById("chipPinned");
      const chipToday = document.getElementById("chipToday");

      const navItems = document.querySelectorAll(".nav-item, .logo");

      let notes = [];
      let activeNoteId = null;
      let autosaveTimer = null;
      let statsVisible = true;
      let todayFilter = false;

      function loadNotes() {
        try {
          const saved = localStorage.getItem(STORAGE_KEY);
          if (saved) {
            notes = JSON.parse(saved);
          } else {
            notes = [
              {
                id: Date.now(),
                title: "TaskFlows notes",
                content:
                  "Welcome to Notes in TaskFlows.\n\nUse this space to capture ideas, school notes, to do breakdowns and anything else you need.\n\nSome quick ideas:\n‚Ä¢ Brain dump for today\n‚Ä¢ Project checklist details\n‚Ä¢ Reflection journal for the week\n‚Ä¢ Study plan for exams\n\nTry adding tags like `school`, `math`, or `ideas` to group notes easily.",
                tags: ["setup", "taskflows"],
                color: "#f97373",
                pinned: true,
                updatedAt: Date.now(),
              },
            ];
          }
        } catch (e) {
          notes = [];
        }

        if (!Array.isArray(notes)) notes = [];
        if (notes.length === 0) {
          createNewNote(true);
        } else {
          activeNoteId = notes[0].id;
        }
        renderNotes();
        updateEditor();
      }

      function saveNotes(force = false) {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
          if (force) {
            lastSavedLabel.textContent = "Saved ¬∑ " + new Date().toLocaleTimeString();
          }
        } catch (e) {
          console.error("Failed to save notes", e);
        }
      }

      function debouncedSave() {
        if (autosaveTimer) clearTimeout(autosaveTimer);
        autosaveTimer = setTimeout(() => {
          saveNotes(true);
          lastSavedLabel.textContent = "Saved ¬∑ " + new Date().toLocaleTimeString();
        }, 500);
      }

      function formatTime(timestamp) {
        const date = new Date(timestamp);
        const now = new Date();
        const isToday = date.toDateString() === now.toDateString();
        const options = isToday
          ? { hour: "2-digit", minute: "2-digit" }
          : { month: "short", day: "numeric" };
        return date.toLocaleString(undefined, options);
      }

      function isTodayDate(timestamp) {
        const d = new Date(timestamp);
        const now = new Date();
        return d.getFullYear() === now.getFullYear() &&
          d.getMonth() === now.getMonth() &&
          d.getDate() === now.getDate();
      }

      function getFilteredSortedNotes() {
        const query = searchInput.value.trim().toLowerCase();
        const pinnedFilter = filterPinnedSelect.value;
        const tagFilter = filterTagInput.value.trim().toLowerCase();
        const sortBy = sortSelect.value;

        let result = notes.slice();

        if (query) {
          result = result.filter((note) => {
            const tagsString = note.tags.join(" ").toLowerCase();
            return (
              note.title.toLowerCase().includes(query) ||
              note.content.toLowerCase().includes(query) ||
              tagsString.includes(query)
            );
          });
        }

        if (pinnedFilter !== "all") {
          const shouldBePinned = pinnedFilter === "pinned";
          result = result.filter((note) => note.pinned === shouldBePinned);
        }

        if (tagFilter) {
          result = result.filter((note) =>
            note.tags.some((tag) => tag.toLowerCase().includes(tagFilter))
          );
        }

        if (todayFilter) {
          result = result.filter((note) => isTodayDate(note.updatedAt));
        }

        result.sort((a, b) => {
          if (sortBy === "recent") {
            if (a.pinned !== b.pinned) return a.pinned ? -1 : 1;
            return b.updatedAt - a.updatedAt;
          } else if (sortBy === "az") {
            return a.title.localeCompare(b.title);
          } else if (sortBy === "za") {
            return b.title.localeCompare(a.title);
          } else if (sortBy === "pinned") {
            if (a.pinned !== b.pinned) return a.pinned ? -1 : 1;
            return b.updatedAt - a.updatedAt;
          }
          return 0;
        });

        return result;
      }

      function renderNotes() {
        const list = getFilteredSortedNotes();
        notesListEl.innerHTML = "";

        noteCountEl.textContent = notes.length.toString();
        if (!searchInput.value && !filterTagInput.value && !todayFilter && filterPinnedSelect.value === "all") {
          listSubLabel.textContent = "Pinned first ¬∑ Local only";
        } else {
          listSubLabel.textContent = "Filtered view ¬∑ " + list.length + " visible";
        }

        if (list.length === 0) {
          const empty = document.createElement("div");
          empty.className = "empty-state";
          empty.style.border = "none";
          empty.innerHTML =
            '<div><span>‚ú®</span>No notes match this view. Clear filters or create a new note.</div>';
          notesListEl.appendChild(empty);
          return;
        }

        list.forEach((note) => {
          const item = document.createElement("div");
          item.className = "note-item" + (note.id === activeNoteId ? " active" : "");
          item.dataset.id = note.id;

          const header = document.createElement("div");
          header.className = "note-item-header";

          const colorDot = document.createElement("div");
          colorDot.className = "note-color-dot";
          colorDot.style.background = note.color || "#f97373";

          const title = document.createElement("div");
          title.className = "note-title";
          title.textContent = note.title || "Untitled note";

          const meta = document.createElement("div");
          meta.className = "note-meta";

          if (note.pinned) {
            const pin = document.createElement("span");
            pin.className = "note-pin";
            pin.textContent = "üìå";
            meta.appendChild(pin);
          }

          const time = document.createElement("span");
          time.textContent = formatTime(note.updatedAt);
          meta.appendChild(time);

          header.appendChild(colorDot);
          header.appendChild(title);
          header.appendChild(meta);

          const preview = document.createElement("div");
          preview.className = "note-preview";
          preview.textContent = note.content || "Empty note";

          const tagsContainer = document.createElement("div");
          tagsContainer.className = "note-tags";
          note.tags.slice(0, 3).forEach((tag) => {
            const tagEl = document.createElement("div");
            tagEl.className = "note-tag";
            tagEl.textContent = "#" + tag;
            tagsContainer.appendChild(tagEl);
          });

          item.appendChild(header);
          item.appendChild(preview);
          if (note.tags.length) {
            item.appendChild(tagsContainer);
          }

          item.addEventListener("click", () => {
            activeNoteId = note.id;
            updateEditor();
            renderNotes();
          });

          // Double click to toggle pin quickly
          item.addEventListener("dblclick", (e) => {
            e.stopPropagation();
            activeNoteId = note.id;
            togglePinActiveNote(true);
          });

          notesListEl.appendChild(item);
        });
      }

      function getActiveNote() {
        return notes.find((n) => n.id === activeNoteId) || null;
      }

      function updateEditor() {
        const note = getActiveNote();

        if (!note) {
          editorWrapper.style.display = "none";
          emptyState.style.display = "flex";
          editorSubLabel.textContent = "No note selected";
          return;
        }

        editorWrapper.style.display = "flex";
        emptyState.style.display = "none";

        noteTitleInput.value = note.title;
        noteTagsInput.value = note.tags.join(", ");
        noteContentInput.value = note.content;
        lastSavedLabel.textContent = "Last edited ¬∑ " + formatTime(note.updatedAt);
        editorSubLabel.textContent = note.pinned ? "Pinned note ¬∑ autosaving" : "Standard note ¬∑ autosaving";

        colorDots.forEach((dot) => {
          const color = dot.getAttribute("data-color");
          dot.classList.toggle("active", color === note.color);
        });

        updateStats();
        renderNotes();
      }

      function createNewNote(skipFocus) {
        const now = Date.now();
        const newNote = {
          id: now,
          title: "Untitled note",
          content: "",
          tags: [],
          color: "#f97373",
          pinned: false,
          updatedAt: now,
        };
        notes.unshift(newNote);
        activeNoteId = newNote.id;
        renderNotes();
        updateEditor();
        saveNotes(true);
        if (!skipFocus) {
          noteTitleInput.focus();
          noteTitleInput.select();
        }
      }

      function deleteActiveNote() {
        const note = getActiveNote();
        if (!note) return;
        const idx = notes.findIndex((n) => n.id === note.id);
        if (idx === -1) return;

        notes.splice(idx, 1);
        if (notes.length === 0) {
          activeNoteId = null;
        } else {
          activeNoteId = notes[0].id;
        }
        renderNotes();
        updateEditor();
        saveNotes(true);
      }

      function duplicateActiveNote() {
        const note = getActiveNote();
        if (!note) return;
        const now = Date.now();
        const clone = {
          ...note,
          id: now,
          title: note.title + " (copy)",
          updatedAt: now,
        };
        notes.unshift(clone);
        activeNoteId = clone.id;
        renderNotes();
        updateEditor();
        saveNotes(true);
      }

      function togglePinActiveNote(silent) {
        const note = getActiveNote();
        if (!note) return;
        note.pinned = !note.pinned;
        note.updatedAt = Date.now();
        pinToggleBtn.innerHTML = note.pinned
          ? '<span>üìå</span> Unpin'
          : '<span>üìå</span> Pin';
        renderNotes();
        saveNotes(true);
        editorSubLabel.textContent = note.pinned ? "Pinned note ¬∑ autosaving" : "Standard note ¬∑ autosaving";
        if (!silent) {
          // nothing extra, keep minimal
        }
      }

      function updateStats() {
        const text = noteContentInput.value || "";
        const words = text.trim() ? text.trim().split(/\s+/).length : 0;
        const chars = text.length;
        const readMinutes = Math.max(1, Math.round(words / 200)) || 0;

        if (statsVisible) {
          wordCountLabel.textContent = words + " words";
          charCountLabel.textContent = chars + " chars";
          readTimeLabel.textContent = readMinutes + " min read";
          wordCountLabel.parentElement.style.display = "flex";
        } else {
          wordCountLabel.parentElement.style.display = "none";
        }
      }

      function updateActiveNoteFromInputs() {
        const note = getActiveNote();
        if (!note) return;

        note.title = noteTitleInput.value.trim() || "Untitled note";
        const tags = noteTagsInput.value
          .split(",")
          .map((t) => t.trim())
          .filter(Boolean);
        note.tags = tags;
        note.content = noteContentInput.value;
        note.updatedAt = Date.now();
        lastSavedLabel.textContent = "Editing‚Ä¶";
        updateStats();
        debouncedSave();
        renderNotes();
      }

      function setFontSize(size) {
        smallSizeBtn.classList.remove("active");
        mediumSizeBtn.classList.remove("active");
        largeSizeBtn.classList.remove("active");

        if (size === "small") {
          smallSizeBtn.classList.add("active");
          noteContentInput.style.fontSize = "12px";
        } else if (size === "large") {
          largeSizeBtn.classList.add("active");
          noteContentInput.style.fontSize = "14.5px";
        } else {
          mediumSizeBtn.classList.add("active");
          noteContentInput.style.fontSize = "13px";
        }
      }

      function toggleWrap() {
        const isWrapped = noteContentInput.style.whiteSpace !== "pre";
        if (isWrapped) {
          noteContentInput.style.whiteSpace = "pre";
          noteContentInput.style.overflowX = "auto";
          wrapToggleBtn.classList.remove("active");
        } else {
          noteContentInput.style.whiteSpace = "pre-wrap";
          noteContentInput.style.overflowX = "hidden";
          wrapToggleBtn.classList.add("active");
        }
      }

      function toggleStats() {
        statsVisible = !statsVisible;
        statsToggleBtn.classList.toggle("active", statsVisible);
        updateStats();
      }

      function setNoteColor(color) {
        const note = getActiveNote();
        if (!note) return;
        note.color = color;
        note.updatedAt = Date.now();
        colorDots.forEach((dot) => {
          const c = dot.getAttribute("data-color");
          dot.classList.toggle("active", c === color);
        });
        saveNotes(true);
        renderNotes();
      }

      function applyTemplate(templateType) {
        const note = getActiveNote();
        if (!note) {
          createNewNote(false);
        }
        const today = new Date();
        const dateStr = today.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "numeric" });
        let template = "";

        if (templateType === "study") {
          template =
            `Study Session ¬∑ ${dateStr}

Subject:
Topic:
Goal for today:

Key concepts:
‚Ä¢ 
‚Ä¢ 
‚Ä¢ 

Questions I still have:
‚Ä¢ 

Next steps for tomorrow:
‚Ä¢ `;
        } else if (templateType === "journal") {
          template =
            `Daily Journal ¬∑ ${dateStr}

Today I am grateful for:
‚Ä¢ 

What went well today:
‚Ä¢ 

What I could improve:
‚Ä¢ 

Small win to remember:
‚Ä¢ `;
        } else if (templateType === "meeting") {
          template =
            `Meeting Notes ¬∑ ${dateStr}

Title:
Participants:

Agenda:
‚Ä¢ 

Key points:
‚Ä¢ 

Actions:
‚Ä¢ Task ‚Äî owner ‚Äî due
‚Ä¢ 

Notes:
`;
        }

        noteContentInput.value = template;
        updateActiveNoteFromInputs();
      }

      // Event listeners
      newNoteBtn.addEventListener("click", () => {
        createNewNote(false);
      });

      deleteBtn.addEventListener("click", () => {
        deleteActiveNote();
      });

      duplicateBtn.addEventListener("click", () => {
        duplicateActiveNote();
      });

      pinToggleBtn.addEventListener("click", () => {
        togglePinActiveNote(false);
      });

      focusToggleBtn.addEventListener("click", () => {
        document.body.classList.toggle("focus-mode");
      });

      noteTitleInput.addEventListener("input", updateActiveNoteFromInputs);
      noteTagsInput.addEventListener("input", updateActiveNoteFromInputs);
      noteContentInput.addEventListener("input", updateActiveNoteFromInputs);

      searchInput.addEventListener("input", renderNotes);
      sortSelect.addEventListener("change", renderNotes);
      filterPinnedSelect.addEventListener("change", renderNotes);
      filterTagInput.addEventListener("input", renderNotes);

      filtersToggleBtn.addEventListener("click", () => {
        const isHidden = toolbarAdvanced.style.display === "none";
        toolbarAdvanced.style.display = isHidden ? "flex" : "none";
      });

      smallSizeBtn.addEventListener("click", () => setFontSize("small"));
      mediumSizeBtn.addEventListener("click", () => setFontSize("medium"));
      largeSizeBtn.addEventListener("click", () => setFontSize("large"));
      wrapToggleBtn.addEventListener("click", toggleWrap);
      statsToggleBtn.addEventListener("click", toggleStats);

      colorDots.forEach((dot) => {
        dot.addEventListener("click", () => {
          const color = dot.getAttribute("data-color");
          setNoteColor(color);
        });
      });

      templateStudyBtn.addEventListener("click", () => applyTemplate("study"));
      templateJournalBtn.addEventListener("click", () => applyTemplate("journal"));
      templateMeetingBtn.addEventListener("click", () => applyTemplate("meeting"));

      // Quick add
      quickAddInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && quickAddInput.value.trim()) {
          const now = Date.now();
          const newNote = {
            id: now,
            title: quickAddInput.value.trim(),
            content: "",
            tags: [],
            color: "#f97373",
            pinned: false,
            updatedAt: now,
          };
          notes.unshift(newNote);
          activeNoteId = newNote.id;
          quickAddInput.value = "";
          renderNotes();
          updateEditor();
          saveNotes(true);
        }
      });

      // Chip filters
      function setChipActive(chip) {
        [chipAll, chipPinned, chipToday].forEach((c) => c.classList.remove("active"));
        chip.classList.add("active");
      }

      chipAll.addEventListener("click", () => {
        setChipActive(chipAll);
        filterPinnedSelect.value = "all";
        todayFilter = false;
        renderNotes();
      });

      chipPinned.addEventListener("click", () => {
        setChipActive(chipPinned);
        filterPinnedSelect.value = "pinned";
        todayFilter = false;
        renderNotes();
      });

      chipToday.addEventListener("click", () => {
        setChipActive(chipToday);
        filterPinnedSelect.value = "all";
        todayFilter = true;
        renderNotes();
      });

      // Navigation buttons
      navItems.forEach((btn) => {
        btn.addEventListener("click", () => {
          const link = btn.getAttribute("data-link");
          if (link) {
            window.location.href = link;
          }
        });
      });

      // Keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        const isMac = navigator.platform.toUpperCase().indexOf("MAC") >= 0;
        const metaKey = isMac ? e.metaKey : e.ctrlKey;

        if (e.key === "/" && document.activeElement !== searchInput) {
          e.preventDefault();
          searchInput.focus();
          searchInput.select();
        }

        if (metaKey && e.key.toLowerCase() === "n") {
          e.preventDefault();
          createNewNote(false);
        }

        if (metaKey && e.key.toLowerCase() === "s") {
          e.preventDefault();
          saveNotes(true);
          lastSavedLabel.textContent = "Saved ¬∑ " + new Date().toLocaleTimeString();
        }

        if (metaKey && e.key.toLowerCase() === "p") {
          e.preventDefault();
          togglePinActiveNote(false);
        }
      });

      // Initial settings
      setFontSize("medium");
      wrapToggleBtn.classList.add("active");
      noteContentInput.style.whiteSpace = "pre-wrap";
      statsToggleBtn.classList.add("active");
      notesListEl.style.scrollBehavior = "smooth";

      loadNotes();
    })();
  </script>
</body>

</html>
<meta charset="UTF-8" />
<title>TaskFlows ¬∑ Notes</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" type="image/x-icon" href="Untitled-removebg-preview.png" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
<style>
  :root {
    --bg: #f5f5f7;
    --bg-soft: #ffffff;
    --bg-soft-alt: #f9fafb;
    --border-subtle: #e5e7eb;
    --border-strong: #d1d5db;
    --accent: #ef4444;
    --accent-soft: rgba(239, 68, 68, 0.08);
    --accent-border: rgba(239, 68, 68, 0.55);
    --text: #111827;
    --text-soft: #6b7280;
    --text-softer: #9ca3af;
    --radius-lg: 14px;
    --radius-xl: 18px;
    --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.06);
    --transition-fast: 140ms ease-out;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html,
  body {
    height: 100%;
  }

  body {
    font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--text);
    -webkit-font-smoothing: antialiased;
  }

  .app {
    display: flex;
    min-height: 100vh;
    width: 100%;
    background: var(--bg);
  }

  /* SIDEBAR */
  .sidebar {
    width: 250px;
    background: #ffffff;
    border-right: 1px solid #e5e7eb;
    padding: 16px 14px 18px;
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
  }

  .logo-pill {
    width: 30px;
    height: 30px;
    border-radius: 999px;
    background: #111827;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 700;
    color: #f9fafb;
  }

  .logo-text-main {
    font-weight: 600;
    font-size: 15px;
    letter-spacing: 0.02em;
  }

  .logo-text-sub {
    font-size: 11px;
    color: var(--text-soft);
  }

  .workspace-chip {
    font-size: 11px;
    padding: 4px 10px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: var(--bg-soft-alt);
    color: var(--text-soft);
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }

  .sidebar-section {
    margin-top: 4px;
  }

  .sidebar-title {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: var(--text-softer);
    margin-bottom: 6px;
    padding: 0 4px;
  }

  .nav-group {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .nav-item {
    border: none;
    background: transparent;
    color: var(--text-soft);
    font-size: 13px;
    padding: 6px 10px;
    border-radius: 999px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 8px;
    cursor: pointer;
    transition: background var(--transition-fast), color var(--transition-fast), transform 70ms ease-out;
  }

  .nav-emoji {
    font-size: 15px;
  }

  .nav-label {
    font-size: 13px;
  }

  .nav-item:hover {
    background: #f3f4f6;
    color: #111827;
    transform: translateY(-1px);
  }

  .nav-item.active {
    background: var(--accent-soft);
    color: #b91c1c;
  }

  .sidebar-footer {
    margin-top: auto;
    padding-top: 10px;
    border-top: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;
    gap: 6px;
    font-size: 11px;
    color: var(--text-softer);
  }

  .sidebar-footer-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .sync-dot {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: #22c55e;
  }

  /* MAIN */
  .main {
    flex: 1;
    padding: 16px 20px 18px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .top-bar {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .top-title {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .top-title-main {
    font-size: 18px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .top-pill {
    font-size: 11px;
    padding: 3px 8px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    color: var(--text-soft);
    display: inline-flex;
    align-items: center;
    gap: 4px;
    background: #ffffff;
  }

  .top-title-sub {
    font-size: 12px;
    color: var(--text-soft);
  }

  .top-actions {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .btn {
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #ffffff;
    color: var(--text);
    font-size: 11px;
    padding: 6px 11px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    transition: background var(--transition-fast), border-color var(--transition-fast), transform 70ms ease-out, box-shadow var(--transition-fast);
  }

  .btn span {
    font-size: 14px;
  }

  .btn-primary {
    background: #111827;
    border-color: #111827;
    color: #f9fafb;
  }

  .btn-primary:hover {
    background: #020617;
    border-color: #020617;
    transform: translateY(-1px);
    box-shadow: 0 10px 20px rgba(15, 23, 42, 0.25);
  }

  .btn-ghost {
    background: #ffffff;
  }

  .btn:hover {
    background: #f3f4f6;
    border-color: var(--border-strong);
    transform: translateY(-0.5px);
  }

  .btn-icon-only {
    width: 32px;
    height: 32px;
    padding: 0;
    align-items: center;
    justify-content: center;
  }

  .btn-small {
    padding: 4px 9px;
    font-size: 11px;
  }

  .toolbar {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .toolbar-main {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .search {
    flex: 1;
    position: relative;
  }

  .search input {
    width: 100%;
    padding: 7px 11px 7px 26px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #ffffff;
    color: var(--text);
    font-size: 12px;
    outline: none;
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast);
  }

  .search input::placeholder {
    color: var(--text-softer);
  }

  .search input:focus {
    border-color: var(--accent-border);
    box-shadow: 0 0 0 1px var(--accent-border);
    background: #ffffff;
  }

  .search-icon {
    position: absolute;
    left: 9px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 13px;
    color: var(--text-softer);
  }

  .chip-group {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    background: #ffffff;
    padding: 2px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
  }

  .chip {
    border-radius: 999px;
    border: none;
    background: transparent;
    font-size: 11px;
    padding: 4px 9px;
    color: var(--text-soft);
    cursor: pointer;
    transition: background var(--transition-fast), color var(--transition-fast), transform 70ms ease-out;
  }

  .chip:hover {
    background: #f3f4f6;
    color: #111827;
  }

  .chip.active {
    background: #111827;
    color: #f9fafb;
  }

  .toolbar-advanced {
    display: none;
    margin-top: 6px;
    display: flex;
    gap: 8px;
    align-items: center;
    font-size: 11px;
  }

  .toolbar-advanced-inner {
    padding: 6px 8px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #ffffff;
    display: inline-flex;
    gap: 8px;
    align-items: center;
  }

  .toolbar-select,
  .toolbar-input {
    font-size: 11px;
    padding: 4px 8px;
    border-radius: 999px;
    border: 1px solid transparent;
    background: #f9fafb;
    color: var(--text-soft);
    outline: none;
    cursor: pointer;
    min-width: 90px;
  }

  .toolbar-input {
    min-width: 0;
    width: 150px;
    cursor: text;
  }

  .toolbar-select:focus,
  .toolbar-input:focus {
    border-color: var(--accent-border);
  }

  .toolbar-advanced-label {
    font-size: 11px;
    color: var(--text-softer);
    margin-left: 2px;
  }

  /* CONTENT */
  .content {
    flex: 1;
    display: grid;
    grid-template-columns: minmax(0, 0.8fr) minmax(0, 1.4fr);
    gap: 12px;
    min-height: 0;
  }

  .panel {
    background: #ffffff;
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-subtle);
    padding: 10px 10px 8px;
    display: flex;
    flex-direction: column;
    min-height: 0;
    box-shadow: var(--shadow-soft);
  }

  .panel-header-compact {
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .panel-header-left {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .panel-title {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-soft);
  }

  .panel-sub {
    font-size: 11px;
    color: var(--text-softer);
  }

  .note-counter {
    font-size: 11px;
    padding: 2px 8px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #f9fafb;
    color: var(--text-soft);
  }

  /* NOTES LIST */
  .notes-list {
    overflow-y: auto;
    padding-right: 4px;
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .notes-list::-webkit-scrollbar {
    width: 4px;
  }

  .notes-list::-webkit-scrollbar-track {
    background: transparent;
  }

  .notes-list::-webkit-scrollbar-thumb {
    background: #d1d5db;
    border-radius: 999px;
  }

  .note-item {
    border-radius: 10px;
    padding: 7px 9px;
    background: #ffffff;
    border: 1px solid var(--border-subtle);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    gap: 4px;
    transition: background var(--transition-fast), border-color var(--transition-fast), transform 70ms ease-out, box-shadow var(--transition-fast);
    position: relative;
  }

  .note-item:hover {
    background: #f9fafb;
    border-color: var(--border-strong);
    transform: translateY(-1px);
    box-shadow: 0 8px 18px rgba(15, 23, 42, 0.04);
  }

  .note-item.active {
    border-color: var(--accent-border);
    background: #fff;
    box-shadow: 0 10px 22px rgba(239, 68, 68, 0.12);
  }

  .note-item-header {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .note-color-dot {
    width: 9px;
    height: 9px;
    border-radius: 999px;
    flex-shrink: 0;
  }

  .note-title {
    font-size: 13px;
    font-weight: 500;
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .note-meta {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 10px;
    color: var(--text-softer);
  }

  .note-pin {
    font-size: 12px;
  }

  .note-preview {
    font-size: 11px;
    color: var(--text-soft);
    line-height: 1.4;
    max-height: 32px;
    overflow: hidden;
  }

  .note-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 1px;
  }

  .note-tag {
    font-size: 9px;
    padding: 1px 6px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #f9fafb;
    color: var(--text-softer);
    max-width: 110px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .quick-add {
    border-radius: 999px;
    border: 1px dashed var(--border-subtle);
    padding: 6px 9px;
    font-size: 11px;
    color: var(--text-softer);
    background: #f9fafb;
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: text;
  }

  .quick-add span {
    font-size: 13px;
  }

  .quick-add input {
    border: none;
    outline: none;
    background: transparent;
    font-size: 11px;
    flex: 1;
    color: var(--text);
  }

  .quick-add input::placeholder {
    color: var(--text-softer);
  }

  /* EDITOR */
  .editor-wrapper {
    display: flex;
    flex-direction: column;
    gap: 6px;
    flex: 1;
    min-height: 0;
  }

  .editor-top-row {
    display: flex;
    gap: 6px;
  }

  .editor-title-input {
    flex: 1;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #ffffff;
    color: var(--text);
    padding: 7px 12px;
    font-size: 14px;
    font-weight: 500;
    outline: none;
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
  }

  .editor-title-input::placeholder {
    color: var(--text-softer);
  }

  .editor-title-input:focus {
    border-color: var(--accent-border);
    box-shadow: 0 0 0 1px var(--accent-border);
  }

  .editor-tag-input {
    width: 190px;
    border-radius: 999px;
    border: 1px dashed var(--border-subtle);
    background: #ffffff;
    color: var(--text);
    padding: 7px 12px;
    font-size: 11px;
    outline: none;
  }

  .editor-tag-input::placeholder {
    color: var(--text-softer);
  }

  .editor-toolbar {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 6px;
    border-radius: 999px;
    border: 1px solid var(--border-subtle);
    background: #f9fafb;
    font-size: 11px;
    color: var(--text-softer);
  }

  .editor-toolbar-group {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .editor-toolbar-group+.editor-toolbar-group {
    border-left: 1px solid #e5e7eb;
    padding-left: 6px;
    margin-left: 4px;
  }

  .editor-tool-btn {
    border: none;
    background: transparent;
    color: var(--text-softer);
    font-size: 12px;
    padding: 4px 6px;
    border-radius: 999px;
    cursor: pointer;
    transition: background var(--transition-fast), color var(--transition-fast), transform 70ms ease-out;
  }

  .editor-tool-btn span {
    font-size: 13px;
  }

  .editor-tool-btn:hover {
    background: #e5e7eb;
    color: var(--text);
    transform: translateY(-0.5px);
  }

  .editor-tool-btn.active {
    background: #111827;
    color: #f9fafb;
  }

  .editor-color-dot {
    width: 14px;
    height: 14px;
    border-radius: 999px;
    cursor: pointer;
    transition: transform 70ms ease-out, box-shadow var(--transition-fast);
    border: 1px solid #e5e7eb;
  }

  .editor-color-dot:hover {
    transform: translateY(-0.5px) scale(1.02);
    box-shadow: 0 0 0 2px #e5e7eb;
  }

  .editor-color-dot.active {
    box-shadow: 0 0 0 2px var(--accent-border);
  }

  .editor-main {
    flex: 1;
    margin-top: 4px;
    border-radius: 12px;
    border: 1px solid var(--border-subtle);
    background: #ffffff;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  .editor-textarea {
    flex: 1;
    padding: 10px 12px;
    background: transparent;
    border: none;
    resize: none;
    color: var(--text);
    font-size: 13px;
    line-height: 1.6;
    outline: none;
    min-height: 0;
  }

  .editor-textarea::placeholder {
    color: var(--text-softer);
  }

  .editor-status-bar {
    border-top: 1px solid var(--border-subtle);
    padding: 4px 9px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 11px;
    color: var(--text-softer);
    background: #f9fafb;
  }

  .editor-status-left,
  .editor-status-right {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .status-pill {
    padding: 2px 8px;
    border-radius: 999px;
    background: #ffffff;
    border: 1px solid var(--border-subtle);
  }

  /* EMPTY STATE */
  .empty-state {
    flex: 1;
    border-radius: 10px;
    border: 1px dashed var(--border-subtle);
    background: #f9fafb;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 14px;
    text-align: center;
    font-size: 12px;
    color: var(--text-soft);
  }

  .empty-state span {
    display: block;
    font-size: 18px;
    margin-bottom: 6px;
  }

  /* FOCUS MODE */
  body.focus-mode .sidebar {
    display: none;
  }

  body.focus-mode .content {
    grid-template-columns: minmax(0, 0.7fr) minmax(0, 1.3fr);
  }

  body.focus-mode .main {
    padding-left: 20px;
  }

  /* RESPONSIVE */
  @media (max-width: 960px) {
    .sidebar {
      display: none;
    }

    .content {
      grid-template-columns: 1fr;
    }

    .top-actions {
      display: none;
    }
  }

  @media (max-width: 640px) {
    .toolbar {
      flex-direction: column;
      align-items: stretch;
    }

    .toolbar-main {
      width: 100%;
    }

    .chip-group {
      margin-top: 4px;
    }

    .editor-top-row {
      flex-direction: column;
    }

    .editor-tag-input {
      width: 100%;
    }
  }
</style>
</head>

<body>
  <div class="app">
    <!-- SIDEBAR NAV -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo" data-link="dashboard.html">
          <div class="logo-pill">TF</div>
          <div>
            <div class="logo-text-main">TaskFlows</div>
            <div class="logo-text-sub">Personal workspace</div>
          </div>
        </div>
        <div class="workspace-chip">
          <span>‚óè</span>
          Workspace
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Workspace</div>
        <div class="nav-group">
          <button class="nav-item" data-link="text-editor.html">
            <span class="nav-emoji">üìù</span>
            <span class="nav-label">Text Editor</span>
          </button>
          <button class="nav-item" data-link="to-do-list.html">
            <span class="nav-emoji">‚úÖ</span>
            <span class="nav-label">To-Do Lists</span>
          </button>
          <button class="nav-item" data-link="dashboard.html">
            <span class="nav-emoji">üìä</span>
            <span class="nav-label">Dashboard</span>
          </button>
          <button class="nav-item active" data-link="notes.html">
            <span class="nav-emoji">üóíÔ∏è</span>
            <span class="nav-label">Notes</span>
          </button>
          <button class="nav-item" data-link="whiteboard.html">
            <span class="nav-emoji">üñäÔ∏è</span>
            <span class="nav-label">Whiteboard</span>
          </button>
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Personal</div>
        <div class="nav-group">
          <button class="nav-item" data-link="lists.html">
            <span class="nav-emoji">üìã</span>
            <span class="nav-label">Lists</span>
          </button>
          <button class="nav-item" data-link="journal.html">
            <span class="nav-emoji">üìì</span>
            <span class="nav-label">Journal</span>
          </button>
          <button class="nav-item" data-link="quick-notes.html">
            <span class="nav-emoji">‚úèÔ∏è</span>
            <span class="nav-label">Quick Notes</span>
          </button>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="sidebar-footer-row">
          <span>Sync status</span>
          <span class="sync-dot"></span>
        </div>
        <div class="sidebar-footer-row">
          <span>Local backup</span>
          <span>Auto ¬∑ 5s</span>
        </div>
      </div>
    </aside>

    <!-- MAIN AREA -->
    <main class="main">
      <!-- TOP BAR -->
      <div class="top-bar">
        <div class="top-title">
          <div class="top-title-main">
            üóíÔ∏è Notes
            <div class="top-pill">
              <span>‚åò N</span> new note
            </div>
          </div>
          <div class="top-title-sub">
            Minimal notes for everything: ideas, study breakdowns, journals and project docs.
          </div>
        </div>

        <div class="top-actions">
          <button class="btn btn-ghost btn-small" id="focusToggleBtn" title="Toggle focus mode">
            <span>üåì</span> Focus
          </button>
          <button class="btn btn-ghost btn-small" id="pinToggleBtn" title="Pin or unpin current note">
            <span>üìå</span> Pin
          </button>
          <button class="btn btn-ghost btn-small" id="duplicateBtn" title="Duplicate current note">
            <span>üß¨</span> Duplicate
          </button>
          <button class="btn btn-ghost btn-small" id="deleteBtn" title="Archive current note">
            <span>üóëÔ∏è</span> Archive
          </button>
          <button class="btn btn-primary" id="newNoteBtn">
            <span>‚ûï</span> New note
          </button>
        </div>
      </div>

      <!-- TOOLBAR -->
      <div class="toolbar">
        <div class="toolbar-main">
          <div class="search">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Search by title, content, or tags  ¬∑  press / to focus" />
          </div>
          <div class="chip-group">
            <button class="chip active" id="chipAll">All</button>
            <button class="chip" id="chipPinned">Pinned</button>
            <button class="chip" id="chipToday">Today</button>
          </div>
        </div>
        <button class="btn btn-ghost btn-small" id="filtersToggleBtn">
          <span>‚öôÔ∏è</span> Filters
        </button>
      </div>

      <div class="toolbar-advanced" id="toolbarAdvanced" style="display: none;">
        <span class="toolbar-advanced-label">View options</span>
        <div class="toolbar-advanced-inner">
          <select id="sortSelect" class="toolbar-select">
            <option value="recent">Sort ¬∑ Recent</option>
            <option value="az">Sort ¬∑ A ‚Üí Z</option>
            <option value="za">Sort ¬∑ Z ‚Üí A</option>
            <option value="pinned">Sort ¬∑ Pinned first</option>
          </select>
          <select id="filterPinnedSelect" class="toolbar-select">
            <option value="all">All notes</option>
            <option value="pinned">Pinned only</option>
            <option value="normal">Unpinned only</option>
          </select>
          <input type="text" id="filterTagInput" class="toolbar-input" placeholder="Filter by tag (eg: school)" />
        </div>
      </div>

      <!-- CONTENT -->
      <div class="content">
        <!-- LEFT: NOTES LIST -->
        <section class="panel">
          <div class="panel-header-compact">
            <div class="panel-header-left">
              <div class="panel-title">Your notes</div>
              <div class="panel-sub" id="listSubLabel">Pinned first ¬∑ Local only</div>
            </div>
            <div class="note-counter">
              <span id="noteCount">0</span> notes
            </div>
          </div>

          <div class="quick-add">
            <span>‚ûï</span>
            <input id="quickAddInput" placeholder="Quick capture a new note title and press Enter" />
          </div>

          <div class="notes-list" id="notesList"></div>
        </section>

        <!-- RIGHT: EDITOR -->
        <section class="panel">
          <div class="panel-header-compact">
            <div class="panel-header-left">
              <div class="panel-title">Editor</div>
              <div class="panel-sub" id="editorSubLabel">Select a note or create a new one</div>
            </div>
          </div>

          <div class="editor-wrapper" id="editorWrapper">
            <div class="editor-top-row">
              <input type="text" id="noteTitleInput" class="editor-title-input" placeholder="Note title" />
              <input type="text" id="noteTagsInput" class="editor-tag-input" placeholder="Tags (comma separated)" />
            </div>

            <div class="editor-toolbar">
              <div class="editor-toolbar-group">
                <button class="editor-tool-btn" id="smallSizeBtn" title="Small text">
                  A
                </button>
                <button class="editor-tool-btn active" id="mediumSizeBtn" title="Medium text">
                  A
                </button>
                <button class="editor-tool-btn" id="largeSizeBtn" title="Large text">
                  A
                </button>
              </div>

              <div class="editor-toolbar-group">
                <button class="editor-tool-btn" id="wrapToggleBtn" title="Toggle line wrap">
                  <span>‚ÜîÔ∏è</span>
                </button>
                <button class="editor-tool-btn" id="statsToggleBtn" title="Toggle stats">
                  <span>üìä</span>
                </button>
              </div>

              <div class="editor-toolbar-group">
                <span class="panel-sub">Color</span>
                <div class="editor-color-dot active" data-color="#f97373" style="background:#f97373"></div>
                <div class="editor-color-dot" data-color="#38bdf8" style="background:#38bdf8"></div>
                <div class="editor-color-dot" data-color="#a855f7" style="background:#a855f7"></div>
                <div class="editor-color-dot" data-color="#22c55e" style="background:#22c55e"></div>
              </div>

              <div class="editor-toolbar-group">
                <button class="editor-tool-btn" id="templateStudyBtn" title="Insert study template">
                  üìö
                </button>
                <button class="editor-tool-btn" id="templateJournalBtn" title="Insert journal template">
                  üìì
                </button>
                <button class="editor-tool-btn" id="templateMeetingBtn" title="Insert meeting template">
                  üë•
                </button>
              </div>
            </div>

            <div class="editor-main">
              <textarea id="noteContentInput" class="editor-textarea" placeholder="Start typing your note here...

Tips:
‚Ä¢ ‚åò N / Ctrl N to create a note
‚Ä¢ ‚åò S / Ctrl S to force save
‚Ä¢ / to jump to search
‚Ä¢ Double click a note to pin or unpin it"></textarea>
              <div class="editor-status-bar">
                <div class="editor-status-left">
                  <div class="status-pill" id="wordCountLabel">0 words</div>
                  <div class="status-pill" id="charCountLabel">0 chars</div>
                  <div class="status-pill" id="readTimeLabel">0 min read</div>
                </div>
                <div class="editor-status-right">
                  <span id="lastSavedLabel">Not saved yet</span>
                </div>
              </div>
            </div>
          </div>

          <div class="empty-state" id="emptyState" style="display: none;">
            <div>
              <span>üóíÔ∏è</span>
              No note selected yet. Click <strong>New note</strong> or pick one from the list on the left.
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    (function () {
      const STORAGE_KEY = "taskflows_notes_v2";

      const notesListEl = document.getElementById("notesList");
      const noteCountEl = document.getElementById("noteCount");
      const noteTitleInput = document.getElementById("noteTitleInput");
      const noteTagsInput = document.getElementById("noteTagsInput");
      const noteContentInput = document.getElementById("noteContentInput");
      const wordCountLabel = document.getElementById("wordCountLabel");
      const charCountLabel = document.getElementById("charCountLabel");
      const readTimeLabel = document.getElementById("readTimeLabel");
      const lastSavedLabel = document.getElementById("lastSavedLabel");
      const editorWrapper = document.getElementById("editorWrapper");
      const emptyState = document.getElementById("emptyState");
      const editorSubLabel = document.getElementById("editorSubLabel");
      const listSubLabel = document.getElementById("listSubLabel");
      const quickAddInput = document.getElementById("quickAddInput");

      const newNoteBtn = document.getElementById("newNoteBtn");
      const deleteBtn = document.getElementById("deleteBtn");
      const duplicateBtn = document.getElementById("duplicateBtn");
      const pinToggleBtn = document.getElementById("pinToggleBtn");
      const focusToggleBtn = document.getElementById("focusToggleBtn");

      const searchInput = document.getElementById("searchInput");
      const sortSelect = document.getElementById("sortSelect");
      const filterPinnedSelect = document.getElementById("filterPinnedSelect");
      const filterTagInput = document.getElementById("filterTagInput");
      const filtersToggleBtn = document.getElementById("filtersToggleBtn");
      const toolbarAdvanced = document.getElementById("toolbarAdvanced");

      const smallSizeBtn = document.getElementById("smallSizeBtn");
      const mediumSizeBtn = document.getElementById("mediumSizeBtn");
      const largeSizeBtn = document.getElementById("largeSizeBtn");
      const wrapToggleBtn = document.getElementById("wrapToggleBtn");
      const statsToggleBtn = document.getElementById("statsToggleBtn");
      const colorDots = document.querySelectorAll(".editor-color-dot");

      const templateStudyBtn = document.getElementById("templateStudyBtn");
      const templateJournalBtn = document.getElementById("templateJournalBtn");
      const templateMeetingBtn = document.getElementById("templateMeetingBtn");

      const chipAll = document.getElementById("chipAll");
      const chipPinned = document.getElementById("chipPinned");
      const chipToday = document.getElementById("chipToday");

      const navItems = document.querySelectorAll(".nav-item, .logo");

      let notes = [];
      let activeNoteId = null;
      let autosaveTimer = null;
      let statsVisible = true;
      let todayFilter = false;

      function loadNotes() {
        try {
          const saved = localStorage.getItem(STORAGE_KEY);
          if (saved) {
            notes = JSON.parse(saved);
          } else {
            notes = [
              {
                id: Date.now(),
                title: "TaskFlows notes",
                content:
                  "Welcome to Notes in TaskFlows.\n\nUse this space to capture ideas, school notes, to do breakdowns and anything else you need.\n\nSome quick ideas:\n‚Ä¢ Brain dump for today\n‚Ä¢ Project checklist details\n‚Ä¢ Reflection journal for the week\n‚Ä¢ Study plan for exams\n\nTry adding tags like `school`, `math`, or `ideas` to group notes easily.",
                tags: ["setup", "taskflows"],
                color: "#f97373",
                pinned: true,
                updatedAt: Date.now(),
              },
            ];
          }
        } catch (e) {
          notes = [];
        }

        if (!Array.isArray(notes)) notes = [];
        if (notes.length === 0) {
          createNewNote(true);
        } else {
          activeNoteId = notes[0].id;
        }
        renderNotes();
        updateEditor();
      }

      function saveNotes(force = false) {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
          if (force) {
            lastSavedLabel.textContent = "Saved ¬∑ " + new Date().toLocaleTimeString();
          }
        } catch (e) {
          console.error("Failed to save notes", e);
        }
      }

      function debouncedSave() {
        if (autosaveTimer) clearTimeout(autosaveTimer);
        autosaveTimer = setTimeout(() => {
          saveNotes(true);
          lastSavedLabel.textContent = "Saved ¬∑ " + new Date().toLocaleTimeString();
        }, 500);
      }

      function formatTime(timestamp) {
        const date = new Date(timestamp);
        const now = new Date();
        const isToday = date.toDateString() === now.toDateString();
        const options = isToday
          ? { hour: "2-digit", minute: "2-digit" }
          : { month: "short", day: "numeric" };
        return date.toLocaleString(undefined, options);
      }

      function isTodayDate(timestamp) {
        const d = new Date(timestamp);
        const now = new Date();
        return d.getFullYear() === now.getFullYear() &&
          d.getMonth() === now.getMonth() &&
          d.getDate() === now.getDate();
      }

      function getFilteredSortedNotes() {
        const query = searchInput.value.trim().toLowerCase();
        const pinnedFilter = filterPinnedSelect.value;
        const tagFilter = filterTagInput.value.trim().toLowerCase();
        const sortBy = sortSelect.value;

        let result = notes.slice();

        if (query) {
          result = result.filter((note) => {
            const tagsString = note.tags.join(" ").toLowerCase();
            return (
              note.title.toLowerCase().includes(query) ||
              note.content.toLowerCase().includes(query) ||
              tagsString.includes(query)
            );
          });
        }

        if (pinnedFilter !== "all") {
          const shouldBePinned = pinnedFilter === "pinned";
          result = result.filter((note) => note.pinned === shouldBePinned);
        }

        if (tagFilter) {
          result = result.filter((note) =>
            note.tags.some((tag) => tag.toLowerCase().includes(tagFilter))
          );
        }

        if (todayFilter) {
          result = result.filter((note) => isTodayDate(note.updatedAt));
        }

        result.sort((a, b) => {
          if (sortBy === "recent") {
            if (a.pinned !== b.pinned) return a.pinned ? -1 : 1;
            return b.updatedAt - a.updatedAt;
          } else if (sortBy === "az") {
            return a.title.localeCompare(b.title);
          } else if (sortBy === "za") {
            return b.title.localeCompare(a.title);
          } else if (sortBy === "pinned") {
            if (a.pinned !== b.pinned) return a.pinned ? -1 : 1;
            return b.updatedAt - a.updatedAt;
          }
          return 0;
        });

        return result;
      }

      function renderNotes() {
        const list = getFilteredSortedNotes();
        notesListEl.innerHTML = "";

        noteCountEl.textContent = notes.length.toString();
        if (!searchInput.value && !filterTagInput.value && !todayFilter && filterPinnedSelect.value === "all") {
          listSubLabel.textContent = "Pinned first ¬∑ Local only";
        } else {
          listSubLabel.textContent = "Filtered view ¬∑ " + list.length + " visible";
        }

        if (list.length === 0) {
          const empty = document.createElement("div");
          empty.className = "empty-state";
          empty.style.border = "none";
          empty.innerHTML =
            '<div><span>‚ú®</span>No notes match this view. Clear filters or create a new note.</div>';
          notesListEl.appendChild(empty);
          return;
        }

        list.forEach((note) => {
          const item = document.createElement("div");
          item.className = "note-item" + (note.id === activeNoteId ? " active" : "");
          item.dataset.id = note.id;

          const header = document.createElement("div");
          header.className = "note-item-header";

          const colorDot = document.createElement("div");
          colorDot.className = "note-color-dot";
          colorDot.style.background = note.color || "#f97373";

          const title = document.createElement("div");
          title.className = "note-title";
          title.textContent = note.title || "Untitled note";

          const meta = document.createElement("div");
          meta.className = "note-meta";

          if (note.pinned) {
            const pin = document.createElement("span");
            pin.className = "note-pin";
            pin.textContent = "üìå";
            meta.appendChild(pin);
          }

          const time = document.createElement("span");
          time.textContent = formatTime(note.updatedAt);
          meta.appendChild(time);

          header.appendChild(colorDot);
          header.appendChild(title);
          header.appendChild(meta);

          const preview = document.createElement("div");
          preview.className = "note-preview";
          preview.textContent = note.content || "Empty note";

          const tagsContainer = document.createElement("div");
          tagsContainer.className = "note-tags";
          note.tags.slice(0, 3).forEach((tag) => {
            const tagEl = document.createElement("div");
            tagEl.className = "note-tag";
            tagEl.textContent = "#" + tag;
            tagsContainer.appendChild(tagEl);
          });

          item.appendChild(header);
          item.appendChild(preview);
          if (note.tags.length) {
            item.appendChild(tagsContainer);
          }

          item.addEventListener("click", () => {
            activeNoteId = note.id;
            updateEditor();
            renderNotes();
          });

          // Double click to toggle pin quickly
          item.addEventListener("dblclick", (e) => {
            e.stopPropagation();
            activeNoteId = note.id;
            togglePinActiveNote(true);
          });

          notesListEl.appendChild(item);
        });
      }

      function getActiveNote() {
        return notes.find((n) => n.id === activeNoteId) || null;
      }

      function updateEditor() {
        const note = getActiveNote();

        if (!note) {
          editorWrapper.style.display = "none";
          emptyState.style.display = "flex";
          editorSubLabel.textContent = "No note selected";
          return;
        }

        editorWrapper.style.display = "flex";
        emptyState.style.display = "none";

        noteTitleInput.value = note.title;
        noteTagsInput.value = note.tags.join(", ");
        noteContentInput.value = note.content;
        lastSavedLabel.textContent = "Last edited ¬∑ " + formatTime(note.updatedAt);
        editorSubLabel.textContent = note.pinned ? "Pinned note ¬∑ autosaving" : "Standard note ¬∑ autosaving";

        colorDots.forEach((dot) => {
          const color = dot.getAttribute("data-color");
          dot.classList.toggle("active", color === note.color);
        });

        updateStats();
        renderNotes();
      }

      function createNewNote(skipFocus) {
        const now = Date.now();
        const newNote = {
          id: now,
          title: "Untitled note",
          content: "",
          tags: [],
          color: "#f97373",
          pinned: false,
          updatedAt: now,
        };
        notes.unshift(newNote);
        activeNoteId = newNote.id;
        renderNotes();
        updateEditor();
        saveNotes(true);
        if (!skipFocus) {
          noteTitleInput.focus();
          noteTitleInput.select();
        }
      }

      function deleteActiveNote() {
        const note = getActiveNote();
        if (!note) return;
        const idx = notes.findIndex((n) => n.id === note.id);
        if (idx === -1) return;

        notes.splice(idx, 1);
        if (notes.length === 0) {
          activeNoteId = null;
        } else {
          activeNoteId = notes[0].id;
        }
        renderNotes();
        updateEditor();
        saveNotes(true);
      }

      function duplicateActiveNote() {
        const note = getActiveNote();
        if (!note) return;
        const now = Date.now();
        const clone = {
          ...note,
          id: now,
          title: note.title + " (copy)",
          updatedAt: now,
        };
        notes.unshift(clone);
        activeNoteId = clone.id;
        renderNotes();
        updateEditor();
        saveNotes(true);
      }

      function togglePinActiveNote(silent) {
        const note = getActiveNote();
        if (!note) return;
        note.pinned = !note.pinned;
        note.updatedAt = Date.now();
        pinToggleBtn.innerHTML = note.pinned
          ? '<span>üìå</span> Unpin'
          : '<span>üìå</span> Pin';
        renderNotes();
        saveNotes(true);
        editorSubLabel.textContent = note.pinned ? "Pinned note ¬∑ autosaving" : "Standard note ¬∑ autosaving";
        if (!silent) {
          // nothing extra, keep minimal
        }
      }

      function updateStats() {
        const text = noteContentInput.value || "";
        const words = text.trim() ? text.trim().split(/\s+/).length : 0;
        const chars = text.length;
        const readMinutes = Math.max(1, Math.round(words / 200)) || 0;

        if (statsVisible) {
          wordCountLabel.textContent = words + " words";
          charCountLabel.textContent = chars + " chars";
          readTimeLabel.textContent = readMinutes + " min read";
          wordCountLabel.parentElement.style.display = "flex";
        } else {
          wordCountLabel.parentElement.style.display = "none";
        }
      }

      function updateActiveNoteFromInputs() {
        const note = getActiveNote();
        if (!note) return;

        note.title = noteTitleInput.value.trim() || "Untitled note";
        const tags = noteTagsInput.value
          .split(",")
          .map((t) => t.trim())
          .filter(Boolean);
        note.tags = tags;
        note.content = noteContentInput.value;
        note.updatedAt = Date.now();
        lastSavedLabel.textContent = "Editing‚Ä¶";
        updateStats();
        debouncedSave();
        renderNotes();
      }

      function setFontSize(size) {
        smallSizeBtn.classList.remove("active");
        mediumSizeBtn.classList.remove("active");
        largeSizeBtn.classList.remove("active");

        if (size === "small") {
          smallSizeBtn.classList.add("active");
          noteContentInput.style.fontSize = "12px";
        } else if (size === "large") {
          largeSizeBtn.classList.add("active");
          noteContentInput.style.fontSize = "14.5px";
        } else {
          mediumSizeBtn.classList.add("active");
          noteContentInput.style.fontSize = "13px";
        }
      }

      function toggleWrap() {
        const isWrapped = noteContentInput.style.whiteSpace !== "pre";
        if (isWrapped) {
          noteContentInput.style.whiteSpace = "pre";
          noteContentInput.style.overflowX = "auto";
          wrapToggleBtn.classList.remove("active");
        } else {
          noteContentInput.style.whiteSpace = "pre-wrap";
          noteContentInput.style.overflowX = "hidden";
          wrapToggleBtn.classList.add("active");
        }
      }

      function toggleStats() {
        statsVisible = !statsVisible;
        statsToggleBtn.classList.toggle("active", statsVisible);
        updateStats();
      }

      function setNoteColor(color) {
        const note = getActiveNote();
        if (!note) return;
        note.color = color;
        note.updatedAt = Date.now();
        colorDots.forEach((dot) => {
          const c = dot.getAttribute("data-color");
          dot.classList.toggle("active", c === color);
        });
        saveNotes(true);
        renderNotes();
      }

      function applyTemplate(templateType) {
        const note = getActiveNote();
        if (!note) {
          createNewNote(false);
        }
        const today = new Date();
        const dateStr = today.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "numeric" });
        let template = "";

        if (templateType === "study") {
          template =
            `Study Session ¬∑ ${dateStr}

Subject:
Topic:
Goal for today:

Key concepts:
‚Ä¢ 
‚Ä¢ 
‚Ä¢ 

Questions I still have:
‚Ä¢ 

Next steps for tomorrow:
‚Ä¢ `;
        } else if (templateType === "journal") {
          template =
            `Daily Journal ¬∑ ${dateStr}

Today I am grateful for:
‚Ä¢ 

What went well today:
‚Ä¢ 

What I could improve:
‚Ä¢ 

Small win to remember:
‚Ä¢ `;
        } else if (templateType === "meeting") {
          template =
            `Meeting Notes ¬∑ ${dateStr}

Title:
Participants:

Agenda:
‚Ä¢ 

Key points:
‚Ä¢ 

Actions:
‚Ä¢ Task ‚Äî owner ‚Äî due
‚Ä¢ 

Notes:
`;
        }

        noteContentInput.value = template;
        updateActiveNoteFromInputs();
      }

      // Event listeners
      newNoteBtn.addEventListener("click", () => {
        createNewNote(false);
      });

      deleteBtn.addEventListener("click", () => {
        deleteActiveNote();
      });

      duplicateBtn.addEventListener("click", () => {
        duplicateActiveNote();
      });

      pinToggleBtn.addEventListener("click", () => {
        togglePinActiveNote(false);
      });

      focusToggleBtn.addEventListener("click", () => {
        document.body.classList.toggle("focus-mode");
      });

      noteTitleInput.addEventListener("input", updateActiveNoteFromInputs);
      noteTagsInput.addEventListener("input", updateActiveNoteFromInputs);
      noteContentInput.addEventListener("input", updateActiveNoteFromInputs);

      searchInput.addEventListener("input", renderNotes);
      sortSelect.addEventListener("change", renderNotes);
      filterPinnedSelect.addEventListener("change", renderNotes);
      filterTagInput.addEventListener("input", renderNotes);

      filtersToggleBtn.addEventListener("click", () => {
        const isHidden = toolbarAdvanced.style.display === "none";
        toolbarAdvanced.style.display = isHidden ? "flex" : "none";
      });

      smallSizeBtn.addEventListener("click", () => setFontSize("small"));
      mediumSizeBtn.addEventListener("click", () => setFontSize("medium"));
      largeSizeBtn.addEventListener("click", () => setFontSize("large"));
      wrapToggleBtn.addEventListener("click", toggleWrap);
      statsToggleBtn.addEventListener("click", toggleStats);

      colorDots.forEach((dot) => {
        dot.addEventListener("click", () => {
          const color = dot.getAttribute("data-color");
          setNoteColor(color);
        });
      });

      templateStudyBtn.addEventListener("click", () => applyTemplate("study"));
      templateJournalBtn.addEventListener("click", () => applyTemplate("journal"));
      templateMeetingBtn.addEventListener("click", () => applyTemplate("meeting"));

      // Quick add
      quickAddInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && quickAddInput.value.trim()) {
          const now = Date.now();
          const newNote = {
            id: now,
            title: quickAddInput.value.trim(),
            content: "",
            tags: [],
            color: "#f97373",
            pinned: false,
            updatedAt: now,
          };
          notes.unshift(newNote);
          activeNoteId = newNote.id;
          quickAddInput.value = "";
          renderNotes();
          updateEditor();
          saveNotes(true);
        }
      });

      // Chip filters
      function setChipActive(chip) {
        [chipAll, chipPinned, chipToday].forEach((c) => c.classList.remove("active"));
        chip.classList.add("active");
      }

      chipAll.addEventListener("click", () => {
        setChipActive(chipAll);
        filterPinnedSelect.value = "all";
        todayFilter = false;
        renderNotes();
      });

      chipPinned.addEventListener("click", () => {
        setChipActive(chipPinned);
        filterPinnedSelect.value = "pinned";
        todayFilter = false;
        renderNotes();
      });

      chipToday.addEventListener("click", () => {
        setChipActive(chipToday);
        filterPinnedSelect.value = "all";
        todayFilter = true;
        renderNotes();
      });

      // Navigation buttons
      navItems.forEach((btn) => {
        btn.addEventListener("click", () => {
          const link = btn.getAttribute("data-link");
          if (link) {
            window.location.href = link;
          }
        });
      });

      // Keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        const isMac = navigator.platform.toUpperCase().indexOf("MAC") >= 0;
        const metaKey = isMac ? e.metaKey : e.ctrlKey;

        if (e.key === "/" && document.activeElement !== searchInput) {
          e.preventDefault();
          searchInput.focus();
          searchInput.select();
        }

        if (metaKey && e.key.toLowerCase() === "n") {
          e.preventDefault();
          createNewNote(false);
        }

        if (metaKey && e.key.toLowerCase() === "s") {
          e.preventDefault();
          saveNotes(true);
          lastSavedLabel.textContent = "Saved ¬∑ " + new Date().toLocaleTimeString();
        }

        if (metaKey && e.key.toLowerCase() === "p") {
          e.preventDefault();
          togglePinActiveNote(false);
        }
      });

      // Initial settings
      setFontSize("medium");
      wrapToggleBtn.classList.add("active");
      noteContentInput.style.whiteSpace = "pre-wrap";
      statsToggleBtn.classList.add("active");
      notesListEl.style.scrollBehavior = "smooth";

      loadNotes();
    })();
  </script>
</body>

</html>
